<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="ru">
<head>
<!-- 
Automatically generated, don't change: 
$Id: faq_different_types_content.htm,v 1.2 2008/07/18 17:54:11 fizick Exp $ 
-->
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
  <title>Часто задаваемые вопросы - Распознавание и обработка контента различного типов</title>
  <style type="text/css"></style>
  <link rel="stylesheet" type="text/css" href="../avisynth.css">
</head>
<body>

<h1>AviSynth FAQ - Распознавание и обработка контента различных типов</h1>

<h2>Содержание</h2>
<ol>
  <li>
<a href="#The_video_and_audio_in_my_final_encoding_is_out_of_sync,_what_should_I_do.3F">Видео и аудио 
в моем закодированном файле несинхронны, что мне делать?</a></li>
  <li>
<a href="#How_do_I_recognize_progressive.2C_interlaced.2C_telecined.2C_hybrid_and_blended_content.3F">Как
мне распознать прогрессивный, чересстрочный, телекино-преобразованный, гибридный и полученный смешением контенты?</a></li>
  <li>
<a href="#How_do_I_process_interlaced_content.3F">Как обрабатывать чересстрочное видео?</a></li>
  <li>
<a href="#How_do_I_process_telecined_content.3F">Как обрабатывать телекино-преобразованное видео?</a></li>
  <li>
<a href="#How_do_I_process_hybrid_content.3F">Как обрабатывать гибридное видео?</a></li>
  <li>
<a href="#What_is_variable_framerate_video.3F">Что такое видео с переменной частотой кадров?</a></li>
  <li>
<a href="#How_do_I_import_variable_framerate_video_into_AviSynth.3F">Как импортировать видео с переменной частотой в
AviSynth и как его обрабатывать?</a></li>
</ol>

<a name="The_video_and_audio_in_my_final_encoding_is_out_of_sync,_what_should_I_do.3F"></a>
<h3>Видео и аудио 
в моем закодированном файле несинхронны, что мне делать?</h3>
<p>Предполагая, что вы обрабатываете ваше видео с AviSynth, существует
несколько причин, почему ваше закодированный файл несинхронный (нет синхпронизации). 
Наиболее частые причины:</p>
<p>1) Ваш источник уже сам несинхронен (еще до обработки в AviSynth или кодирования). 
Его трудно скорректировать, но это не предмет данного документа
(FAQ).</p>
<p>2) Аудио имеет постоянную задержку, и вы забыли эту задержку добавить (либо в
AviSynth, если вы импортируете аудио в AviSynth, или в кодировщике, если вы импортируете
аудио прямо в кодировщик). Например, демультиплексированный аудио поток
из VOB часто имеет задержку. При демультиплексировании этого аудио потока с DGIndex,
эта задержка (в действительности на сколько задержка должна быь скорректирована) записывается в имя
демультиплексированного аудио потока. Вы можете использовать <a href="corefilters/delayaudio.htm">DelayAudio</a>
для добавления задержки в AviSynth.</p>
<pre>vid = MPEG2Source(&quot;D:\movie.d2v&quot;)
aud = NicAC3Source(&quot;D:\movie T01 2_0ch 448Kbps DELAY -218ms.ac3&quot;)
AudioDub(vid, aud)
DelayAudio(-0.218)</pre>
<p>3) Аудио имеет переменную задержку (с нулевой задержкой в начале
и максимальной задержкой в конце). Это может произойти, если вы загружаете в AviSynth
клип, который имеет переменную частоту кадров. Очень много чего, исключая видео содержащееся в
 AVI или MPEG-2/VOB файле, может иметь переменную частоту кадров. Если вы используете
  <a href="corefilters/directshowsource.htm">DirectShowSource</a> для загрузки клипа,
вы можете использовать</p>
<pre># mkv-файл используется здесь в качестве примера:
DirectShowSource(&quot;D:\movie.mkv&quot;, fps=xxx, convertfps=true) # fps = средняя частота кадров</pre>
<p>для принудительной синхронизации. При этом происходит добавление или отбрасывание кадров
для поддержания синхронности, таким образом преобразуя это в видео постоянной частоты.</p>
<p>Если вы не используете DirectShowSource или вы не хотите добавлять и убирать кадры,
то вам необходимо создать сначала файл временных кодов и использовать его позже
при вашем финальном кодировании. Посмотрите <a href="advancedtopics/hybrid_video.htm" title="VFR">эту статью</a> для
более полной информации по этому вопросу.</p>

<a name="How_do_I_recognize_progressive.2C_interlaced.2C_telecined.2C_hybrid_and_blended_content.3F"></a>
<h3>Как мне распознать прогрессивный, чересстрочный, телекино-преобразованный, гибридный и полученный смешением контенты?</h3>
<p>Важно знать, каков ваш контент, если вы хотите обрабатывать его. Наиболее важными являются:
 прогрессивный, чересстрочный, телекино-преобразованный, гибридный и полученный смешением, 
 и они должны обрабатываться различно.</p>
<ul>
  <li>Прогрессивный и чересстрочный (interlaced) контент:<br>
    Большинство фильтров предполагают, что ваш контент - прогрессивный (что означает, что каждый кадр
    снят в различный момент времени), кроме случаев, если фильтр имеет опцию
    interlaced=true/false. Если такая опция присутствует, вы можете использовать
    interlaced=true для чересстрочного (интерлейсного) контента. Для чересстрочного контента, каждое поле
    (а кадр состоит из двух полей) взято в различный момент времени. Это объясняется в
    <a href="http://www.doom9.org/index.html?/capture/introduction.html">Analog
    Capture Guide</a> и руководстве <a href="http://www.doom9.org/ivtc-tut.htm">Force
    Film, IVTC, and Deinterlacing</a>.<br>
  </li>
  <li>Телекино-преобразованный (Telecined) контент:<br>
    Обычно кинофильмы снимаются при 24 к/с (кадров в секунду). При помещении этого на 
    dvd, добавляются поля (полукадры), чтобы получить требуемую частоту кадров 30 к/с (ладно, 
    это в действительности 29.97 к/с, но здесь это пока неважно). При производстве этого,
    контент называется &quot;телекино контент&quot; (это остается  для
    преобразований 25 к/с -&gt; 30 к/с и 24 к/с -&gt; 25 к/с также, при условии что
    добавляются поля). Больше информации об этом может быть найдено 
    в руководстве <a href="http://www.doom9.org/ivtc-tut.htm">Force Film, IVTC, and Deinterlacing</a>.<br>
  </li>
  <li>Гибридный (Hybrid) контент:<br>
    Гибридный контент - это контент с различными базовыми частотами кадров (например 8,
    12, и 16 к/с, при которых часто рисуются мультфильмы анимэ). Start Trek является другим 
    примером, состоящим из телекино-контента (при 30 к/с) и чересстрочного контента (при 30
    к/с). Посмотрите <a href="advancedtopics/hybrid_video.htm" title="VFR">эту статью</a> для
    большей информации по этому вопросу.<br>
  </li>
  <li>Полученный смешением (Blended) контент:<br>
    Полученный смешением контент - это контент, который состоит из смешенных полей (в некоторый полях
    есть видимое содержимое от другого момента времени). Это обычно результат
    плохого преобразования NTSC в PAL (и наоборот), или неправильного деинтерлейса.
    Некоторые примеры могут быть найдены <a href="http://www.doom9.org/index.html?/capture/postprocessing_avisynth.html">здесь</a>
    или <a href="http://www.doom9.org/ivtc-tut.htm">здесь</a>.</li>
</ul>

<a name="How_do_I_process_interlaced_content.3F"></a>
<h3>Как обрабатывать чересстрочное видео?</h3>
<p>Есть два способа обрабатывать чересстрочный контент (предполагая, что вы используете
фильтр, который не имеет опции interlaced=true). Первый способ наиболее аккуратный,
но также медленный: Боб-деинтерлейс (bobbing), обработка и восстановление чересстрочности (reinterlacing). 
Второй способ - быстрый, но также и менее аккуратный: обработка полей (каждой четности)
раздельно.</p>
<p>1) Боб-деинтерлейс:</p>

<pre>AssumeTFF() # или AssumeBFF (установите порядок полей видео корректно!)
TDeint(mode=1, type=3) # или любой другой (умный) Боб (удвоение высоты каждого поля)
Filter(...)
AssumeTFF() # or AssumeBFF (установите порядок полей видео корректно!)
Separatefields()
Selectevery(4,0,3)
Weave()</pre>

<p>2) обработка полей раздельно:</p>

<pre>SeparateFields()
even = SelectEven(last).Filter(...) # четные поля
odd = SelectOdd(last).Filter(...)   # нечетные поля
Interleave(even, odd) # восстановим чересстрочность
Weave()</pre>

<a name="How_do_I_process_telecined_content.3F"></a>
<h3>Как обрабатывать телекино-преобразованное видео?</h3>
<p>Вам необходимо сделать обратное телекино-преобразование (IVTC) перед любой обработкой. Вы можете
например использовать плагин Decomb, который может быть загружен 
<a href="http://neuron2.net/decomb/decombnew.html">здесь</a>.
Смотри руководство &quot;<a href="http://www.doom9.org/ivtc-tut.htm">Force Film,
 IVTC, and Deinterlacing - что DVD2AVI пытается вам сказать и что вы можете с этим делать.</a>&quot;
или &quot;<a href="http://www.doom9.org/index.html?/capture/postprocessing_avisynth.html">the
analog capture guide</a>&quot; которые объясняют, как это делать.</p>

<a name="How_do_I_process_hybrid_content.3F"></a>
<h3>Как обрабатывать гибридное видео?</h3>
<p>Вы встретите затруднения, только если ваш клип, открытый в AviSynth, показывает
гребенку (combing) (будучи частично чересстрочным, телекино, и т.п. ...). Я пока не уверен,
что лучше всего делать в данном случае.</p>

<a name="What_is_variable_framerate_video.3F"></a>
<h3>Что такое видео с переменной частотой кадров?</h3>
<p>Есть два вида видео с точки зрения частоты кадров, видео с постоянной частотой
(cfr) и переменной частотой кадров (vfr). Для cfr видео, кадры имеют постоянную 
длительность, а для vfr видео, кадры имеют непостоянную длительность.
Многие программы-редакторы (включая VirtualDub и AviSynth) предполагают, что видео
является cfr, в частности так как avi не поддерживает vfr. Хотя avi контейнер
не поддерживает vfr, существуют несколько контейнеров (например mkv, mp4 и wmv/asf),
которые поддерживают vfr. Больше информации можно найти <a href="advancedtopics/hybrid_video.htm">здесь</a>.</p>

<a name="How_do_I_import_variable_framerate_video_into_AviSynth.3F"></a>
<h3>Как импортировать видео с переменной частотой в
AviSynth и как его обрабатывать?</h3>
<p>Существуют два способа импортировать видео с переменной частотой в
AviSynth:</p>
<ol>
  <li>Загрузите видео в AviSynth, используя например DirectShowSource(...,
    convertfps=false) или FFmpegSource. Проблемой явлается в этих случаях, что
    при преобразовании в видео постоянной частоты кадры не добавляются или удаляются 
    (что надо бы для синхронности с аудио).<br>
    Сгенерируйте файл временных кодов (timecode), используя некоторую внешнюю программы
    или спользуя плагин AviSynth, который вы используете для импорта видео в AviSynth (если возможно). 
    Многие не-AVI файлы содержат видео с переменной частотой, и в этом случае вам необходимо
    удостовериться в следующих двух вещах:
    <ol>
      <li><i>Не меняйте частоту кадров и число кадров в AviSynth.</i>
        Если вы не выполните это (и вы не подправили файл временного кода вручную),
        то видео и аудио в ваше финальном кодировании будут не сихронны.</li>
      <li><i>Используйте файл временного кода снова, когда мультиплексируете (muxing)
      ваше кодированное видео с audio.</i> Если вы не выполните это,
      то видео и аудио в ваше финальном кодировании будут не синхронны.</li>
    </ol>
  </li>
  <li>Загрузите видео в AviSynth используя например DirectShowSource(...,
    converfps=true). В этом случае кадры будут добавляться или удаляться
    в видео постоянной частоты, для достижения синхронности. Вы можете (дальше) обрабатывать видео любым
    способом, как хотите. Вы можете даже создать новый файл временных кодов и, используя его, 
    создать новое видео с переменной частотой. Больше информации может быть найдено
     <a href="advancedtopics/hybrid_video.htm">здесь</a>.</li>
</ol>
<p>Относительно первого способа. Если вы изменили частоту или число кадров,
вы можете использовать DeDup для создания нового файла временных кодов:</p>
<pre>dedup_dedup(threshold=0.1, maxcopies=10, maxdrops=4, log=&quot;01.log&quot;, timesin=&quot;original.tmc&quot;, times=&quot;final.tmc&quot;)</pre>
<p>Параметр &quot;timesin&quot; указывает файл временных кодов оригинального видео,
на котором будет основываться выходной файл (а не просто используя частоту кадров входного потока). 
Я никогда не использовал это, так что не уверен, насколько способ хорош.
Посмотрите <a href="http://forum.doom9.org/showthread.php?t=121593">обсуждение</a>.</p>

<p>|<a href="faq_sections.htm" title="AviSynth FAQ">
Содержание FAQ</a> | <a href="faq_general_info.htm">Общая информация</a> |
 <a href="faq_loading_clips.htm">Загрузка клипов</a> |
 <a href="faq_frameserving.htm">Открытие скриптов</a> |
 <a href="faq_common_errors.htm">Общие сообщения об ошибках</a> |
 <b>Обработка различного контента</b> |
 <a href="faq_yv12.htm">Работа с YV12</a> |
 <a href="faq_using_virtualdub_plugins.htm">Обработка с плагинами от Virtualdub</a> |</p>

<kbd>$English Date: 2008/07/02 18:57:42 $<br>
Русский перевод 02.07.2008 Fizick http://avisynth.org.ru</kbd>
</body>
</html>