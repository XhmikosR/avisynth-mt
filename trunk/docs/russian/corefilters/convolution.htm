<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="ru">
<head>
<meta http-equiv="Content-Language" content="ru">
<title>GeneralConvolution Avisynth Filter</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="stylesheet" type="text/css" href="../../avisynth.css">
<!--
Automatically generated, don't change:
$Id: convolution.htm,v 1.3 2008/09/08 16:43:48 fizick Exp $
-->
</head>
<body>
<h2><a name="Convolution"></a>GeneralConvolution</h2>
<P><code>GeneralConvolution </code>(<var>clip, int &quot;bias&quot;, string &quot;matrix&quot;, float &quot;divisor&quot;, bool &quot;auto&quot;</var>)
<p>Этот фильтр производит матричную свертку.
</p>
<table border="1" width="75%">
  <tr>
    <td width="34%"><var>clip</var> </td>
    <td width="66%">RGB32 клип</td>
  </tr>
  <tr>
    <td width="34%"><var>bias</var> (default 0)</td>
    <td width="66%">аддитивное смещение для регулировки общей выходной интенсивности</td>
  </tr>
  <tr>
    <td width="34%"><var>matrix</var> (по умолчанию &quot;0 0 0 0 1 0 0 0 0&quot;) </td>
    <td width="66%">может быть 3x3 или 5x5 матрицей с 9 или 25 целыми числами между -256 и 256</td>
  </tr>
  <tr>
    <td width="34%"> <var>divisor</var> (по умолчанию 1.0)</td>
    <td width="66%">делит выход свертки (рассчитывается перед добавлением смещения)</td>
  </tr>
  <tr>
    <td width="34%"><var>auto</var> (по умолчанию true)</td>
    <td width="66%">включает функцию автомасштабирования. Это делит результат на сумму 	элементов матрицы.
     Значение парамтера <var>divisor</var> применяется в дополнение к полученному значению автомасштабирования.
      Если сумма элементов равна нулю, то auto выключается.
	</td>
  </tr>
</table>

<p>Параметр <var>divisor</var> обычно равен сумме элементов матрицы.
 Но когда сумма равна нулю, необходимо использовать параметры <var>divisor</var> и <var>bias</var>
  для коррекции значений пикселов. 
  Параметр <var>bias</var> может быть полезен если значения пикселов негативные после свертки.
   После добавления смещения, значения пикселов ограничиваются снизу нулем, а сверху 255 (если они больше 255).
</p>
<p> Рядом с границами крайние пикселы просто повторяются для подачи в матрицу.
</p>
<p>Несколько примеров:
</p>
<pre># Размывание (блур):

GeneralConvolution(0, &quot;
   10 10 10 10 10
   10 10 10 10 10 
   10 10 16 10 10 
   10 10 10 10 10 
   10 10 10 10 10 &quot;, 256, False)
</pre>
<pre># Горизонтальное (Sobel) детектирование границ:

GeneralConvolution(128, &quot;
    1  2  1 
    0  0  0 
   -1 -2 -1 &quot;, 8)</pre>
      
<pre># Вертикальное (Sobel) детектирование границ:

GeneralConvolution(128, &quot;
   1  0 -1 
   2  0 -2 
   1  0 -1 &quot;, 8)</pre>
      
<pre># Перемещение (просто сдвигает позицию &quot;1&quot; влево, вправо, вверх, вниз):

GeneralConvolution(0,&quot;
   0 1 0 
   0 0 0 
   0 0 0 &quot;)</pre>
      
<pre># Перемещение на половину пикселя (автомасштабирование):

GeneralConvolution(0,&quot;
   0 1 0 
   0 1 0 
   0 0 0 &quot;)</pre>
      
<pre># Перемещение на половину пикселя (ручное масштабирование)::

GeneralConvolution(0,&quot;
   0   0   0 
   0 128 128 
   0   0   0 &quot;, 256, False)</pre>
      
<pre># Фильтр повышения резкости (шарпнесса):

GeneralConvolution(0,&quot;
   0   -1   0 
  -1    5  -1 
   0   -1   0 &quot;, 1, True)

В этом случае новые значения пикселов y(m,n) рассчитываются как :
y(m,n) = (-1*x(m-1,n) - 1*x(m,n-1) + 5*x(m,n) - 1*x(m,n+1)
         - 1*x(m+1,n))/(-1-1+5-1-1)/1.0 + 0</pre>
      
<pre># Легкое размывание с ограничением уровня черного и повышением яркости на 25%:

GeneralConvolution(-16,&quot;
   0   12   0 
  12  256  12 
   0   12   0 &quot;, 0.75 ,True)

В этом случае новые значения пикселов y(m,n) рассчитываются как :
y(m,n) = ( 12*x(m-1,n) + 12*x(m,n-1) + 256*x(m,n) + 12*x(m,n+1)
         + 12*x(m+1,n) )/(12+12+256+12+12)/0.75 - 16</pre>
      
<p>Некоторые другие примеры можно найти 
<a href="http://www.gamedev.net/reference/programming/features/imageproc/page2.asp"><cite>здесь</cite></a>.</p>
<p><b>Лог изменений:</b></p>
<table border="1">
  <tbody>
    <tr>
      <td>v2</td>
      <td>Начальный релиз</td>
    </tr>
    <tr>
      <td>v2.55</td>
      <td>добавлены делитель, авто</td>
    </tr>
  </tbody>
</table>
<p><kbd>$English Date: 2005/05/31 13:57:24 $ <br>
Русский перевод 10.05.2005 Drakon Rider <a href="http://drakan.ru">drakan.ru</a>
</kbd></p>
<FORM>
<INPUT TYPE="Button" VALUE="Назад"
onClick="history.go(-1)">
</form>
</body>
</html>
