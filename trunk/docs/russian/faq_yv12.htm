<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
<!--
Automatically generated, don't change:
$Id: faq_yv12.htm,v 1.2 2008/07/02 20:57:38 fizick Exp $ 
-->
   <meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
   <title> Часто задаваемые вопросы по YV12 </title>
<style type=text/css></style>
   <link rel="stylesheet" type="text/css" href="../avisynth.css">
</head>

<BODY>
<H1>Часто задаваемые вопросы по Avisynth - Цветовой формат YV12 и вопросы его обработки</H1>
<H2>Содержание</H2>
<ol>
<li><A href="#YV12">Что такое YV12?</A></li>
<li><A href="#download_stable_avs">Где я могу скачать последнюю стабильную версию
AviSynth, которая поддерживает YV12?</A></li>
<li><A href="#download_DGIndex">Где
я могу скачать модуль DGIndex/DGDecode, который поддерживает YV12, для импорта
MPEG-1/MPEG-2/TS/PVA в AviSynth?</A></li>
<li><A href="#encoders">Какие программы-кодировщики поддерживают YV12?</A></li>
<li><A href="#encoders2">Как использовать v2.5x, если программы кодирования не могут
обрабатывать YV12 (типа TMPGEnc или CCE SP)?</A></li>
<li><A href="#advantages">Какие основные преимущества обработки в YV12?</A></li>
<li><A href="#VirtualDub">Как использовать
VirtualDub/VirtualDubMod так, чтобы не было ненужных цветовых преобразований?</A></li>
<li><A href="#internal_filters">Какие внутренние фильтры поддерживают YV12?</A></li>
<li><A href="#external_plugins">Какие плагины (внешние модули) поддерживают YV12?</A></li>
<li><A href="#disadvantages">Есть ли недостатки обработки в YV12?</A></li>
<li><A href="#colorspace">Как
узнать, какое цветовое пространство я использую в данном месте в моем скрипте?</A></li>
<li><A href="#colors_swapped">Цвета заменяются, когда я загружаю DivX файл в AviSynth
v2.5?</A></li>
<li><A href="#green_line">Я получаю зеленую (или цветную)
линию слева или справа клипа, как мне избежать этого?</a></li>
<li><A href="#error_message">Я установил AviSynth v2.5 и получил следующее сообщение
об ошибке: "Не могу найти декомпрессор для 'YV12' формата (unknown)"?</A></li>
<li><A href="#black_screen">Я установил AviSynth v2.5
и DivX5 (или одну из последних сборок Xvid),
но все, чего я добился, это черный экран при открытии моего avs в VirtualDub/VirtualDubMod/MPEG-2
кодировщике?</A></li>
<li><A href="#YV12_codecs">Есть ли какие-то беспотерьные YV12 кодеки , которые
я могу использовать для захвата, например?</A></li>
<li><A href="#links">Некоторые важные ссылки</A></li>
</ol>
<H3><A name="YV12"></A>Что такое YV12?</H3>
<P>Это несколько различных способов представление цвета. Например: цветовое пространство
 YUV и RGB. В YUV цветовом пространстве есть один компонент, который представляет
 яркость (сигнал яркости) и два других компонента, которые представляют цвет (сигнал
 цветности). В то время как яркость передается со всеми деталями, некоторые детали
 в компонентах сигнала цветности могут быть удалены путем понижения разрешения отсчетов
 (фильтрация или усреднение), что может быть сделано несколькими способами (т.о.
 есть много форматов для сохранения изображения в цветовом пространстве YUV).
 YV12 - один из таких форматов (тут сигнал цветности общий для каждого блока пиксел
 2x2), который поддерживается AviSynth. Много важных кодеров сохраняли видео в
 YV12: MPEG-4 (x264, XviD, DivX и много других), MPEG-2 на видеодисках DVD, MPEG-1
 и MJPEG.
<H3><A name="download_stable_avs"></A>Где я могу скачать последнюю стабильную
 версию AviSynth, которая поддерживает YV12?</H3>
<P>"AviSynth v2.57" (и более свежие версии) можно загрузить <A href="http://sourceforge.net/project/showfiles.php?group_id=57023">отсюда</A>.
<H3><A name="download_DGIndex"></A>Где я могу скачать модуль DGIndex/DGDecode,
 который поддерживает YV12, для импорта MPEG-1/MPEG-2/TS/PVA в AviSynth ?</H3>
<P>Последний DGIndex/DGDecode комбо можно загрузить <A href="http://neuron2.net/dgmpgdec/dgmpgdec.html">отсюда</A>.
<H3><A name="encoders"></A>Какие программы-кодировщики поддерживают YV12?</H3>
<P>Стандартные сборки Virtualdub (от Avery Lee) имеют поддержку YV12 в режиме
 быстрой рекомпрессии с v1.5.6. Есть также два других способа кодирования в DivX/XviD:<BR>
 Есть измененная версия Virtualdub (названная VirtualdubMod), которая поддерживает
 YV12: Эта версия (от pulco-citron, Suiryc и Belgabor) имеет поддержку OGM и предпросмотра
 AVS. Она может быть загружена <A href="http://sourceforge.net/projects/virtualdubmod">отсюда</A>.
 Чтобы использовать поддержку YV12 (не делая каких-либо цветовых преобразований),
 Вы должны загрузить ваш AVI в VirtualdubMod, и выбрать режим "быстрой рекомпрессии"
 ("fast recompress").<BR>
 Для простой (и быстрой) поддержки YV12, Вы можете также попробовать утилиту командной
 строки <A href="http://www.avs2avi.org">AVS2AVI</A> - она сжимает видео из сценария (скрипта)
 AviSynth, используя любой VFW кодек, смотри также
 <a href="http://forum.doom9.org/showthread.php?t=71493">здесь</a>.<br>
Кодировщики MPEG-1/MPEG-2 <A href="http://www.bitburners.com/HC_Encoder/">
 HC</A> и <A href="http://www.bitburners.com/QuEnc/"> QuEnc</A> также поддерживают
 (и даже требуют) YV12.
<H3><A name="encoders2"></A>Как использовать v2.5x, если программы кодирования
 не могут обрабатывать YV12 (типа TMPGEnc или CCE SP)?</H3>
<P>При использовании TMPGEnc Вы должны добавить в ваш сценарий (скрипт)
 строку &quot;<A href="corefilters/convert.htm">ConvertToRGB24</A>&quot; (с надлежащей
 опцией "чересстрочности" ), а для CCE SP Вы должны добавить в ваш сценарий строку
 "<A href="corefilters/convert.htm">ConvertToYUY2</A>", так как Windows не имеет
 внутреннего YV12 декомпрессора. </P>

<P>Вы можете также установить какой-либо <A href="#error_message">YV12 декомпрессор
 (кодек)</A>, который декомпрессирует
для Вас YV12-AVI при загрузке avi в TMPGEnc или CCE SP.

<H3><A name="advantages"></A>Какие основные преимущества обработки в YV12?</H3>
<UL>
 <LI>увеличение скорости:<BR>
  Это зависит полностью от внешних модулей, имеют ли они поддержку YV12 или нет.
  Ожидается увеличение скорости примерно 25-35%. Конечно же, большое увеличение
  скорости будет только если и ваш исходный и конечный форматы находятся в YV12,
  например при преобразовании DVD до DivX/Xvid.</LI>
 <LI>никаких цветовых преобразований:<BR>
  Цветовая информация не интерполируется (слишком часто) и таким образом остается
  более реалистичной.</LI>
</UL>
<P>MPEG-2 кодеры типа CCE, Procoder и TMPGEnc не могут непосредственно обрабатывать
 входящий YV12. CCE и Procoder нуждаются в YUY2, а TMPGEnc - в RGB24. Это означает
 лишь, что последней строкой AviSynth должен быть вызов <A href="corefilters/convert.htm">ConvertToYUY2</A>
 (для CCE/Procoder, или <A href="corefilters/convert.htm">ConvertToRGB24</A> для
 TMPGEnc), и что Вы не сможете воспользоваться полным преимуществом цветового
 пространства YV12. Однако, есть еще два преимущества:</P>
<OL>
 <LI>Вся внутренняя обработка AviSynth будет все-таки быстрее (меньше данных к
  фильтру, лучше структура для фильтрации и очень быстрое преобразование с YV12
  в YUY2), и Вы наверняка увидите различие между v2.06 и v2.5.</LI>
 <LI>Если Вы делаете прогрессивный клип есть другое преимущество. Откладывая преобразование
  YV12-> YUY2 до конца сценария (скрипта) позволяет Вам вначале проделать процедуру IVTC
  или Deinterlace для создания прогрессивных кадров. Но преобразование YV12 в
  YUY2 для прогрессивных кадров сохраняет больше деталей сигнала цветности чем
  преобразование для чересстрочных или основанных на полях кадров.<BR>
  Цветовые преобразования:<BR>
  CCE: YV12 -> YUY2 -> YV12<BR>
  TMPGEnc: YV12 -> RGB24 -> YV12</LI>
</OL>
<H3><A name="VirtualDub"></A>Как использовать VirtualDub/VirtualDubMod так, чтобы
 не было ненужных цветовых преобразований?</H3>
<P>Просто загрузите ваш avs файл в VirtualDub/VirtualdubMod и установите видео
 на "Быстрая рекомпрессия" (fast recompress). В этом режиме обработка останется в YV12 (вся необходимая
 фильтрация должна быть сделана непосредственно в AviSynth). В меню &quot;Компрессия&quot;
 выберите кодер, который поддерживает YV12, типа Xvid, DivX5, RealVideo (при условии,
 что Вы загружаете последние версии) или 3ivx D4 (при условии, что Вы загружаете
 последние версии). Обратите внимание, что DivX3/4 также поддерживает YV12, за
 исключением того, что пользователи PIV могут испытать сбои при кодировании в
 формат DivX4 в YV12.<BR>
 Если Вы хотите предварительно просмотреть видео, Вы также нуждаетесь в <A href="#error_message">YV12
 декомпрессоре.</A>
<H3><A name="internal_filters"></A>Какие внутренние фильтры поддерживают YV12?</H3>
<P>В принципе все внутренние фильтры поддерживают YV12 изначально. Цветовые форматы,
 поддерживающиеся фильтрами, указаны в документации.
<H3><A name="external_plugins"></A>Какие плагины (внешние модули) поддерживают YV12?</H3>
<P>Плагины, которые откомпилированы для AviSynth v2.5, указаны в файле <A href="externalplugins.htm">Внешние
 плагины</A>. Новые плагины перечислены в этом <A href="http://forum.doom9.org/showthread.php?s=&amp;threadid=84481">дополнении</A>.
 Большинство из них поддерживают YV12 (см. документацию).
<H3><A name="disadvantages"></A>Есть ли недостатки обработки в YV12?</H3>
<UL>
 <LI>Если исходный формат - не YV12 (аналоговый захват, DV), или конечный формат
  кодирования - не YV12, то преобразование цветового формата будет приводить к
  интерполяции сигнала цветности с некоторым ухудшением качества.</LI>
 <LI>Обработка прореженного сигнала цветности может привести
  к некоторому расширению цветности относительно пикселов яркости, особенно для
  чересстрочного видео. </LI>
<li>Из-за того, что цветность в чересстрочном YV12 видео лежит на чередующихся строках, 
  необходимо использовать различные методы повышения/понижения отсчетов при преобразовании
  между YV12 и YUV 4:2:2 или RGB. Это может вести к ошибкам
  повышения/понижения отсчетов цветности, если выбран неверный метод
  для данного видео.</li>
<li>Если YV12 видео хранится в AVI контейнере, не существует метаданных
  для индикации является ли видео черестрочным или прогрессивным. Это означает, что
  приложение или компонент осуществляющий преобразование цвета не имеет простого способа
  выбрать корректный метод преобразования (черестрочный или прогрессивный). Большинство
  преобразователей подразумевают прогрессивный, что может вести к ошибкам повышения отсчетов цветности,
  если в таком окружении  преобразуется чересстрочное виде.</li>
</UL>
<H3><A name="colorspace"></A>Как узнать, какое цветовое пространство я использую
 в данном месте в моем скрипте?</H3>
<P>Чтобы увидеть, какое цветовое пространство Вы используете в данном месте в
 вашем сценарии (скрипте), добавьте:
<PRE>Info()&nbsp;</PRE>
<P>... и AviSynth выдаст Вам много информации о цветовом пространстве и много
 чего другого!
<H3><A name="colors_swapped"></A>Цвета заменяются, когда я загружаю DivX файл
 в AviSynth v2.5?</H3>
<P>Это случается из-за ошибки в старых версиях DivX5. Загрузите последние сборки
 или используйте "<A href="corefilters/swap.htm">SwapUV</A> (клип)&quot;.
<H3><A name="error_message"></A>Я установил AviSynth v2.5 и получил следующее
 сообщение об ошибке: "Не могу найти декомпрессор для 'YV12' формата (unknown)"?</H3>
<P>Установите кодек, который поддерживает YV12. DivX5 или одну из последних <A href="http://www.xvid.org/"> сборок
 XviD</A> или <A href="http://forum.doom9.org/showthread.php?s=&threadid=56972">кодек
 Helix YUV</A>
 или некоторый другой (ffvfw, ffdshow). Если это все еще не работает, измените
 ваш системный реестр как объяснено в следующем вопросе.

<h3><a name="green_line"></a>Я получаю зеленую (или цветную)
линию слева или справа клипа, как мне избежать этого?</h3>
<p>Ваш декодер вероятно неисправен, попробуйте ConvertToRGB() в конце вашего скрипта
просто чтобы удостовериться и проверить, исчезла ли линия. Некоторые приложения
имеют проблемы с отображением YV12 клипов, если ширина или высота 
не кратны 16.</p>
<p>Есть несколько решений этой проблемы:</p>
<ul>
  <li>Попробуйте заставить кодек декодировать в RGB или YUY2 (используя
    pixel_type=&quot;...&quot; аргумент в <a href="corefilters/avisource.htm">AviSource</a>
    или <a href="corefilters/directshowsource">DirectShowSource</a>).</li>
  <li>Используйте кодек, который  декодирует YV12 клипы корректно, даже если ширина или высота
    не кратны 16.</li>
</ul>

<H3><A name="black_screen"></A>Я установил AviSynth v2.5 и DivX5 (или одну из
 последних сборок Xvid), но все, чего я добился, это черный экран при
 открытии моего avs в VirtualDub/VirtualDubMod/MPEG-2 кодировщике?</H3>
<P>Так, видно ваше видео не декомпрессируется DivX 5.02 (или Xvid). Попробуйте
 использовать утилиту <A href="http://members.chello.nl/~p.bekke/">VCSwap</A>
 для переключения на лету видео кодеков.
<P>Опытный пользователь может также сделать это вручную. Зайдите в папку Windows
 и переименуйте файл c именем MSYUV.DLL, или добавьте следующее к вашему файлу
 системного реестра:
<PRE>REGEDIT4&nbsp;

[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Drivers32]&nbsp;
"VIDC.YV12"="divx.dll"</PRE>
<P>Замените "divx.dll" на "xvid.dll" для xvid v0.9 или "xvidvfw.dll" для xvid
 v1.0.
<H3><A name="YV12_codecs"></A>Есть ли какие-то беcпотерьные YV12 кодеки, которые
 я могу использовать для захвата, например?</H3>
<P>Захват в YV12 не рекомендуется из-за проблем с 
чересстрочностью и цветностью; YUY2 будет вообще говроря давать меньше проблем. Беспотерьный (lossless)
YV12 кодек более полезен при сохранении промежуточных файлов перед много-проходным
кодированием, чтобы избежать выполнения скрипта с интернсивной загрузкой процессора несколько раз.
Есть несколько беспотерьных YV12 кодеков:

<UL>
 <LI><A href="http://forum.doom9.org/showthread.php?s=&amp;threadid=53305">VBLE
  кодек (от MarcFD)</A>: Кодек на базе huffyuv [<A href="http://forum.doom9.org/showthread.php?s=&amp;threadid=38389&amp;pagenumber=5">обсуждение</A>].</LI>
 <LI><A href="http://forum.doom9.org/showthread.php?s=&amp;threadid=50363">Loco
  кодек (от TheRealMoh)</A>: см. также <A href="http://forum.doom9.org/showthread.php?s=&amp;threadid=53305">здесь</A></LI>
 <LI><A href="http://www.free-codecs.com/ffvfw_download.htm">ffvfw кодек</A> -
  имеет различные режимы, в частности HuffYUV yv12</LI>
 <LI><A href="http://lags.leetcode.net/codec.html">Lagarith кодек</A> (от Ben
  Greenwood) - лучшее сжатие чем Huffyuv, но медленнее</LI>
</UL>
<H3><A name="links"></A>Некоторые важные ссылки:</H3>
<UL>
 <LI><A href="http://www.fourcc.org/fccyuv.htm#YV12">Техническое объяснение YV12
  (и подобных форматов)</A></LI>
 <LI><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/dnwmt/html/yuvformats.asp">Хорошая
  страница Microsoft по YUV</A></LI>
 <LI><A href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/Display_d/hh/Display_d/dxvaguide_00174d47-49a2-4c28-b67e-ce5a0a58e8ae.xml.asp">Видеоформаты
  пиксел 4:2:0</A>
</UL>

<p>|<a href="faq_sections.htm" title="AviSynth FAQ">
Содержание FAQ</a> | <a href="faq_general_info.htm">Общая информация</a> |
 <a href="faq_loading_clips.htm">Загрузка клипов</a> |
 <a href="faq_frameserving.htm">Открытие скриптов</a> |
 <a href="faq_common_errors.htm">Общие сообщения об ошибках</a> |
 <a href="faq_different_types_content.htm">Обработка различного контента</a> |
 <b>Работа с YV12</b> |
 <a href="faq_using_virtualdub_plugins.htm">Обработка с плагинами от Virtualdub</a> |</p>

<P><KBD>$Engilsh Date: 2008/07/02 20:56:38 $<br>
 Русский перевод 11.12.2006 Soroka (lyakh at iname.com)</KBD><br>
 Обновления 10.06.2007-02.07.2008 Fizick</p>
</BODY>
</HTML>
