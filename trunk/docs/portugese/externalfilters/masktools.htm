<html>
<head>
<title>MaskTools</title>
<link rel="stylesheet" type="text/css" href="../../avisynth.css">
<!--
Automatically generated, don't change:
$Id: masktools.htm,v 1.1 2006/03/26 18:11:53 wilbertd Exp $
-->
</head>
<body>
<h1>MaskTools</h1>
<h2>Abstrato</h2>
<b>autor:</b>  kurosu e Manao
<br><b>versão:</b>     1.5.1
<br><b>download:</b>  <a href="http://www.geocities.com/manao47/Filters/">http://www.geocities.com/manao47/Filters/</a><br>
<b>categoria:</b>   <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Miscelânea de Plugins</span><br>
<b><span style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">requisitos</span>:</b> YV12 Colorspace
<hr>
<h2>Tabela dos conteúdos
</h2>
<ul>
  <li><a href="#masktools">
I) Sobre MaskTools</a>
    <ul>
      <li><a href="#simple">1) Versão Simple</a>s</li>
      <li><a href="#description">2) Descrição</a></li>
    </ul>
  </li>
  <li><a href="#functions">II) Descrições da Função&nbsp;</a></li>
  <li><a href="#examples">III) Alguns usos práticos</a>
    <ul>
      <li><a href="#msharpen">1) MSharpen</a></li>
      <li><a href="#msoften">2) MSoften</a></li>
      <li><a href="#rainbow">3) Redu</a><a href="#description">ção</a> <a href="#rainbow">de
        Arco-íris</a></li>
      <li><a href="#fxtoon">4) Super amostragem de fxtoon</a></li>
      <li><a href="#warpsharp">5) Warpsharp para luma escura</a></li>
      <li><a href="#deinterlacer">6) pseudo-desentrelaçador (croma continua
        problemático)</a></li>
      <li><a href="#rect_overlay">7) Sobreposições não retangulares&nbsp;</a></li>
      <li><a href="#backgournd">8) Substituir fundos</a></li>
      <li><a href="#mftoon">9) Kmf-Toon ;-)</a></li>
    </ul>
  </li>
  <li><a href="#todo">IV) TODO</a>  <font color="#006699"> - a fazer</font></li>
  <li><a href="#disclaimer">V) <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Retratação</span> (<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">não salte essa parte, mas eu não forço a
    aprender isto</span>)</a></li>
  <li><a href="#revisions">VI) Revisões</a></li>
  <li><a href="#developer">VII) Os Ensaios do Desenvolvedor</a></li>
</ul>
<h2><a name="masktools"></a>I) Sobre MaskTools
</h2>
<h3><a name="simple"></a>1) Versão Simples
</h3>
<p style="margin:0cm;margin-bottom:.0001pt">Depois do processo, você pode
precisar manter só parte da produção. Digamos, você tem um clipe suavizado,
resultado de uma suavização (blur() por exemplo) em um clipe fonte.</p>
<p style="margin-top: 0; margin-bottom: 0"><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">A
maioria do ruído da fonte desapareceu, mas assim tem detalhes. Você pode
manter só os píxeis filtrados e descartar os que têm grande diferença de cor
ou brilho.</span>
<p style="margin-top: 0; margin-bottom: 0"><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Isso é o que faz MSmooth por D. Graft, por
exemplo. Agora considere que você grava em uma imagem de píxeis da suavização
e quer manter como píxeis brancos e os outros da fonte como píxeis pretos. Você
obtém uma máscara. MaskTools que trata da criação, encarecimento e manipulação
de tal máscara para cada componente do colorspace YV12.</span></p>
<h3><a name="description"></a>2) Descrição
</h3>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este plugin YV12 do Avisynth 2.5 oferece várias
funções que manipulam clipes como máscaras:</span>
</p>
<ul>
  <li><a href="#binarize">Binarize</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">irá &quot;binarizar&quot; o quadro de entrada
    dependendo de um percentual e um comando.</span></li>
  <li><a href="#combmask">CombMask</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">produz uma máscara com áreas que apresenta
    penteado.</span></li>
  <li><a href="#edgemask">EdgeMask</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">construirá uma máscara das extremidades de um
    clipe, pela aplicação de percentual (valores adequados habilitarão ou os
    desabilitarão).</span></li>
  <li><a href="#expand">Expand</a> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">expandirá os valores altos em um plano, pondo na
    produção o máximo valor na vizinhança 3x3 ao redor do píxel de entrada.
    A função oposta é chamada</span> <a href="#expand">Inpand</a>.</li>
  <li><a href="#fitplane">FitY2UV/FitY2U/FitY2V</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">redimensiona o plano Y e substitui plano(s)
    UV/U/V) pelo resultado do redimensionamento (você pode especificar seu
    filtro redimensionador, até mesmo um que não seja interno do AviSynth); as
    funções opostas são FitU2Y e FitV2Y.</span></li>
  <li><a href="#expand">Inflate</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">vai 'inflar' os valores altos em um plano, pondo
    no plano de produção a média dos 8 vizinhos se é mais alta que o valor
    original, caso contrário, o valor original. A função oposta é chamada <a href="#expand">Deflate</a>
    (dedicado a Phil Katz).</span></li>
  <li><a href="#invert">Invert</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">inverte o píxel (i.e. out = 255 - in); isto também
    pode ser usado para aplicar um efeito 'solarize' ao quadro.</span></li>
  <li><a href="#logic">Logic</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">executa operações lógicas mais típicas (na
    realidade, as funções C mnemônicas do MMX, ainda estão disponíveis,
    principalmente por causa dos limites de dimensões de quadro).</span></li>
  <li><a href="#LUT">RGBLUT/YV12LUT/YV12LUTxy</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">são tabelas que permitem aplicar rapidamente uma função para cada píxel do quadro.</span></li>
  <li><a href="#maskedmerge">MaskedMerge</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">pega 3 clipes e aplica uma pesada fusão entre o
    primeiro e o segundo clipe, dependendo da máscara representada pelo clipe
    3.</span></li>
  <li><a href="#motionmask">MotionMask</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">cria uma máscara do movimento no quadro.</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">OverlayMask compara 2 clipes baseado no
    percentual de luminância e crominância e produz píxeis próximos ou não
    (quase igual ao que ColorKeyMask faz).</span></li>
  <li><a href="#convolution">YV12Convolution</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">permite convolver o quadro pela matriz de sua
    escolha.</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">YV12Layer é o equivalente ao OverLay (sobrepor).</span></li>
  <li><a href="#subtract">YV12Substract</a>  <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">é igual a Subtract (subtrair), também trabalha
    em YV12, mas deve ser um pouco mais rápido (otimizado por MMX).</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Além disso, todas as funções têm 3 parâmetros:
Y, U e V (menos as funções FitPlane onde obviamente o nome diz o que é
processado). Dependendo do seu valor, são aplicadas operações diferentes para
cada plano:</span></p>
<ul>
  <li><span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valor = 3 fará o processo atual do filtro,</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valor = 2 copiará o 2º plano do vídeo (se
    adequado) para produzir o plano correspondente</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valor = 1 não o processará (freqüentemente,
    deixa isto com o 1º plano do clipe ou lixo - confira você mesmo)</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valor = [-255... 0] encherá o plano produzido
    com valor- (para ter níveis cinzas, use U=128,V=128)</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Um último ponto é a habilidade de algumas funções
para processar só uma parte da armação:</span></p>
<ul>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">este comportamento é fixo pelos parâmetros
    (offX, offY) posição do ponto inicial e (w,h) largura e altura da área
    processada; os filtros devem modificar esses parâmetros de forma que a área
    processada esteja dentro dos 2 quadros</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">no caso de um filtro (menos YV12Layer) usando 2
    clipes, eles têm que ter as mesmas dimensões</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">em todos os casos, o quadro deve ser pelo menos
    MOD8 (às vezes MOD16) para habilitar o filtro a usar as funções MMX (e
    trabalhar à velocidade máxima)</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Isto foi planejado para operações modulares e
atômicas (ou tão útil quanto possível), não realmente velocidade. Ficou
inchado e lento. Eu o deixo decidir se esta declaração é totalmente verdade,
ou um pouco menos... Os exemplos em III provavelmente são muito mais rápidos
se aplicados com os filtros originais.</span><br>
</p>
<h2><a name="functions"></a>II) Descrições da Função&nbsp;
</h2>
<h3><a name="binarize"></a>Binarize
</h3>
<p><code>Binarize</code> (<var>clip, int &quot;threshold&quot;, bool
&quot;upper&quot;</var>)<br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">O filtro <font color="#660033">Binarize</font>
permite um percentual básico de um quadro. Se <i><font color="#660033">upper</font></i>=true,
um píxel cujo valor é estritamente superior ao percentual será fixado em
zero, ou senão para 255. Pelo contrário, se <i><font color="#660033">upper</font></i>=false,
um píxel cujo valor é estritamente superior ao percentual será fixado em 255,
ou senão em zero.</span><br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Os padrões são</span>
 <var>threshold </var>= 20 e <var>upper </var>= true.
</p>
<h3><a name="combmask"></a>CombMask
</h3>
<p><code>CombMask</code> (<var>clip, int &quot;thY1&quot;, int &quot;thY2&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro produz uma máscara que exibe áreas
penteadas. Os percentuais trabalham para os outros filtros como: depois de
calcular o valor pente, se este está abaixo de thY1, o píxel é fixado em 0,
acima de thY2, é fixado em 255 e entre eles é fixado ao valor pente dividido
por 256.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">O valor pente é (<font color="#660033">upper_pixel
- pixel</font>)*(<font color="#660033">lower_pixel - pixel</font>). Assim, não
é normalizado à gama 0.. 255, porque se fosse, o valor estaria perto de 1 ou
2, não mais. Isso significa que você pode usar percentual mais alto que 255,
mesmo que eles não sejam úteis.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Os padrões são <i><font color="#660033">thY1</font></i>
= 10 e <font color="#660033"><i>thY2</i> </font>= 10 (assim, uma máscara binária).</span>
</p>
<h3><a name="dedgemask"></a>DEdgeMask
</h3>
<p><code>DEdgeMask</code> (<var>clip, int &quot;thY1&quot;, int
&quot;thY2&quot;, int &quot;thC1&quot;, int &quot;thC2&quot;, string
&quot;matrix&quot;, float &quot;divisor&quot;, bool "setdivisor"</var>)<br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro cria uma máscara de extremidade do
quadro. O algoritmo de achar extremidades usa um núcleo de convolução e o
resultado é então percentualizado com thY1 e thY2 (luma) e thC1 e thC2
(croma). O percentual acontece como (r é o resultado da convolução</span>):
</p>
<ul>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">r &lt;= th1 dá 0.</span></li>
  <li><span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">th1 &lt; r &lt;= th2 dá r.</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">th2 &lt; r dá 255.</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Para criar uma máscara binária, você só tem
que fixar th1=th2.</span></p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A escolha do núcleo de convolução é feita com
<i>matrix</i>. A matriz deve ser 3 por 3, cujos coeficientes são inteiros,
separados por um só espaço. Conseqüentemente, as strings &quot;-1 -1 -1 -1 8
-1 -1 -1 -1&quot; e &quot;0 -1 0 -1 0 1 0 1 0&quot; darão núcleos
respectivamente para o &quot;laplace&quot; e &quot;sobel&quot; do filtro</span>
<a href="#edgemask">EdgeMask</a>.</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Como os coeficientes devem ser inteiros, <i>divisor</i>
é usado para refinar o resultado da convolução. Este resultado simplesmente
será dividido pelo <i>divisor</i>. Se ele não estiver definido, é padronizado
à soma do coeficiente positivo da matriz, permitindo assim uma normalização
clássica. Pode ser um flutuante ou um inteiro, sendo que o posterior é mais rápido.
<var>setdivisor</var>está presente só para compatibilidade inversa. Não use.</span>
<br>
Os <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">padrões são:</span> <var>thY1 </var>= 0, <var>thY2 </var>= 20, <var>thC1 </var>= 0, <var>thC2
</var>= 20 e <var>matrix </var>= &quot;-1 -1 -1 -1 8 -1 -1 -1 -1".</p>
<h3><a name="edgemask"></a>EdgeMask
</h3>
<p><code>EdgeMask</code> (<var>clip, int &quot;thY1&quot;, int &quot;thY2&quot;, int
&quot;thC1&quot;, int &quot;thC2&quot;, string &quot;detector&quot;</var>)<br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro cria uma máscara da extremidade do
quadro. O algoritmo de achar extremidade usa um núcleo de convolução, e o
resultado é então percentualizado com thY1 e thY2 (luma) e thC1 e thC2
(croma). O percentualizado acontece como (r é o resultado da convolução):</span>
</p>
<ul>
  <li> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">r &lt;= th1 dá 0.</span></li>
  <li> <span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">th1 &lt; r &lt;= th2 dá r.</span></li>
  <li> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">th2 &lt; r dá 255.</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Para criar uma máscara binária, você só tem
que fixar th1=th2.</span></p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A escolha do núcleo de convolução é feita
pelo <i><font color="#660033">detector</font></i>:</span></p>
<ul>
  <li><var> detector</var> = "roberts" :<br>
    <table border="1" width="10%">
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">2</td>
        <td width="25%" align="center" height="5%" valign="middle">-1</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">-1</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
      </tr>
    </table>
  </li>
  <li><var> detector</var> = "sobel" :<br>
    <table border="1" width="10%">
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle">-1</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">-1</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle">1</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle">1</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
      </tr>
    </table>
  </li>
  <li><var> detector</var> = "laplace" :<br>
    <table border="1" width="10%">
      <tr>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
        <td width="25%" align="center" height="5%" valign="middle">1</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/8</td>
      </tr>
    </table>
  </li>
  <li><var> detector</var> = "special" :<br>
    <table border="1" width="10%">
      <tr>
        <td width="25%" align="center" height="5%" valign="middle"> -1/4</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/4</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle">1</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
      </tr>
      <tr>
        <td width="25%" align="center" height="5%" valign="middle"> -1/4</td>
        <td width="25%" align="center" height="5%" valign="middle">0</td>
        <td width="25%" align="center" height="5%" valign="middle"> -1/4</td>
      </tr>
    </table>
  </li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Finalmente, também há dois outros possíveis
valores para <i>detector</i> (&quot;cartoon&quot; <span style="mso-spacerun:
yes">&nbsp;</span>e &quot;line&quot;), que têm comportamentos não são
documentados aqui.</span></p>
<p>Os <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">padrões são:</span> <var>thY1 </var>= 0, <var>thY2 </var>= 20, <var>thC1 </var>=
0, <var>thC2 </var>= 20 e <var>detector </var>= &quot;sobel&quot;.</p>
<h3><a name="fitplane"></a>FitY2U / FitY2V / FitY2UV&nbsp; FitU2Y / FitV2Y /
FitU2V / FitV2U</h3>
<p><code>FitPlane</code> (<var>clip, string resizer</var>)&nbsp;</p>
<p><code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"><font color="#660033">FitPlane</font><font color="#000000">
tem as seguintes formações:</font></span></code><br>
   - <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">luma para croma:</span> <code>FitY2U</code>, <code>FitY2V</code>, <code> FitY2UV</code><br>
   - <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">croma</span> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">para luma</span>: <code>FitU2Y</code>, <code> FitV2Y</code><br>
   - <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">croma</span> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">para</span> <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">croma</span>: <code>FitU2V</code>, <code> FitV2U</code></p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Você pode assim reproduzir uma máscara criada
em um plano particular para outro plano.</span></p>
<h3><a name="expand"></a>Inpand / Expand / Deflate / Inflate
</h3>
<p><code>Inpand</code> (<var>clip</var>)<br>
<code>Expand</code> (<var>clip</var>)<br>
<code>Deflate</code> (<var>clip</var>)<br>
<code>Inflate</code> (<var>clip</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Este
filtro permite aumentar / reduzir uma máscara.</span> <code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Expand</span></code>
<code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"><font color="#000000">substituirá
o valor de um píxel pelo valor</font> <font color="#000000">circunvizinho mais
alto.</font></span></code> <code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Inpand
<font color="#000000">ao contrário, substituirá pelo mais baixo valor
circunvizinho.</font></span></code> <code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Inflate</span></code>
<code><span style="font-size:10.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"><font color="#000000">computará
os meios</font> </span></code><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">píxeis</span><code><span style="font-size:10.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"> <font color="#000000">circunvizinho e substituirá
o valor deste píxel só se este</font> <font color="#000000">meio for superior
ao valor do píxel original.</font> Deflate <font color="#000000">fará o mesmo
só se o meio for inferior ao</font> <font color="#000000">valor original.</font></span></code>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">O
quadro </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">retornado</span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;
mso-bidi-language:AR-SA"> por <font color="#660033">Expand</font> / <font color="#660033">Inflate</font>
sempre será mais alto que o quadro original. Pelo contrário, o </span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">retornado</span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"> por <font color="#660033">Inpand</font> / <font color="#660033">Deflate</font>
sempre será mais baixo.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">O aumentado / reduzido produzido por </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"><font color="#660033">Deflate</font></span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> / </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"><font color="#660033">Inflate</font></span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> é mais suave que o
de </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:
&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"><font color="#660033">Expand</font></span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> / </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"><font color="#660033">Inpand</font></span><span style="font-size:10.0pt;
mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">.</span>
</p>
<h3><a name="hysteresymask"></a>HysteresyMask
</h3>
<p><code>HysteresyMask</code> (<var>mask_clip1, mask_clip2</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro cria uma máscara de duas.
Teoricamente, a primeira máscara deve estar dentro da segunda, mas pode
trabalhar se não for true (entretanto os resultados serão menos
interessantes). O princípio do filtro é aumentar as partes que pertencem a
ambas as máscaras, dentro da segunda.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este algoritmo é interessante porque permite
obter uma máscara da extremidade com todas as extremidades interessadas, por
exemplo, mas sem o ruído. Você constrói para aguçar máscaras, um com muitas
extremidades e ruído, o outro com algumas extremidades e quase nenhum ruído.
Então, você usa este filtro e deve obter as extremidades, sem o ruído, porque
o ruído não estava lá na segunda máscara.</span>
</p>
<h3><a name="invert"></a>Invert
</h3>
<p><code>Invert</code> (<var>clip, int offX, int offY, int w, int h</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro troca o valor do píxel pelo de valor
255.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Binarize(upper=false) pode ser visto (mas não é
processado) como</span>&nbsp;
</p>
<p>Invert().Binarize(upper=true)
</p>
<h3><a name="logic"></a>Logic
</h3>
<p><code>Logic</code> (<var>mask_clip1, mask_clip2, string &quot;mode&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro produz uma máscara nova que é o
resultado de uma operação binária entre duas máscaras. A operação é
escolhida com o parâmetro <i>mode</i>.</span>
</p>
<ul>
  <li><var>mode</var>=&quot;and&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">trabalha só com máscaras binárias (só píxeis
    em 0 ou 255). A máscara de produção é a interseção das duas. Significa
    que se ambos os píxeis correspondentes forem 255, o píxel resultante será
    255, senão 0.</span></li>
  <li><var>mode</var>=&quot;or&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">trabalha só com máscaras binárias. A máscara
    produzida é a união das duas. Significa que se um dos píxeis
    correspondentes for 255, o píxel resultante será 255, senão 0.</span></li>
  <li><var>mode</var>=&quot;xor&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">trabalha só com máscaras binárias. A máscara
    produzida é a diferença entre as duas. Significa que se um
    (exclusivamente) dos píxeis correspondente é 255, o pixel resultante será
    255, senão 0.</span></li>
  <li><var>mode</var>=&quot;andn&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">trabalha só com máscaras binárias. A máscara
    produzida é a subtração da segunda máscara e da primeira. Significa que
    se o píxel da primeira máscara é 255 e o segundo é 0, retornará 255,
    senão 0.</span></li>
  <li><var>mode</var>=&quot;min&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">retorna para cada píxel o valor mínimo entre os
    dois píxeis das máscaras de entrada. Soma <span style="mso-spacerun:
yes">&nbsp;</span>a <i><font color="#660033">mode</font></i>=&quot;and&quot;,
    mas para máscaras não binárias.</span></li>
  <li><var>mode</var>=&quot;max&quot; : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">retorna para cada píxel o valor máximo entre o
    dois píxeis das máscaras de entrada. Soma a <i><font color="#660033">mode</font></i>=&quot;or&quot;,
    mas para máscaras não binárias.</span></li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Se um operador lógico for usado com uma máscara
não binária, os resultados são imprevisíveis.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Padrão</span>: <var>mode </var>= &quot;and&quot;.
</p>
<h3><a name="LUT"></a>RGBLUT / YV12LUT / YV12LUTxy
</h3>
<p><code>YV12LUT</code> (<var>clip, string &quot;yexpr&quot;, string
&quot;uexpr&quot;, string &quot;vexpr&quot;</var>)<br>
<code>RGBLUT</code> (<var>clip, string &quot;yexpr&quot;, string
&quot;uexpr&quot;, string &quot;vexpr&quot;, string &quot;AMPFile&quot;</var>)<br>
<code>YV12LUTxy</code> (<var>clipx, clipy, string "yexpr", string "uexpr", string
&quot;vexpr&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Estes
filtros aplicam uma função a cada píxel do quadro. Para permitir uma computação
rápida, todo possível valor da função é pré-computado e armazenado num
tabela. Isso faz os filtros bastante rápidos. </span><code><span style="mso-ansi-language: PT-BR; mso-fareast-language: PT-BR; mso-bidi-language: AR-SA"><font size="2" face="Microsoft Sans Serif">RGBLUT
<font color="#000000">trabalha do mesmo modo como</font> YV12LUT, <font color="#000000">a
não ser por ter um argumento adicional</font> AMPFile.</font></span><span style="font-size:10.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"> </span></code><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Ele permite carregar um perfil de cor do
photoshop.</span>&nbsp;
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">Para
poder aplicar quase toda possível função, este aqui é determinado por uma </span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;
mso-ansi-language:PT-BR;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">string</span><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;
mso-fareast-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA"> que representa uma expressão em notação de
polimento contrário. O princípio desta notação é gravar primeiramente os
operandos / parâmetros de um operador / função e então seus operador / função.
Conseqüentemente, &quot;3 + 7&quot; se tornam &quot;3 7 +&quot;, e
&quot;sin(3)&quot; se torna &quot;seno 3&quot;. Indo além nas explicações,
&quot;3 * 7 + 5&quot; se tornam &quot;3 7 * 5 +&quot;, e &quot;(3 + 7) *
5&quot;:&quot;3 7 + 5 *.&quot; Agora, você entende o recurso principal desta
notação: nenhuma necessidade de parênteses.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Computações são líderes em números reais. Números
positivos também representam uma verdadeira declaração, enquanto que números
negativos representam uma declaração falsa. Na string, o símbolo
&quot;x&quot; é o valor do píxel antes do uso da função. Para YV12LUTxy você
também tem o símbolo &quot;y&quot; que representa o valor do píxel disposto
no segundo clipe. Os símbolos devem ser separados por um único espaço.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Alguns operadores e funções estão
implementados:</span>
</p>
<ul>
  <li>+, -, /, *, ^, % <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">são operadores mais, menos, dividir,
    multiplicar, potência e módulo.</span></li>
  <li>&amp;, |, °, !&amp; <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">são os operadores lógicos and, or, xor, e not.
    Se o resultado for true, eles retornam 1.0, senão -1.0.</span></li>
  <li>&lt;, &lt;=, >, >=, =, != <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">são os operadores de relação menos que, menos
    ou igual a, mais que, mais ou igual a, igual a, não igual a. Se o resultado
    for verdade, eles retornam 1.0, senão -1.0.</span></li>
  <li>cos, sin, tan, acos, asin, atan, exp, log, abs <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">são funções co-seno, seno, tangente,
    arco-coseno, arco-seno, arco-tangente, exponencial, logaritmo de napierian,
    valor absoluto.</span></li>
  <li><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">? permite fazer um teste de condição. É
    operador ternário, o primeiro operando sendo a condição, o segundo o
    valor se a condição é verdade, o terceiro se falso.</span></li>
</ul>
<p><span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Alguns exemplos:</span>
</p>
<p>* <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A binarização do quadro com um percentual em
128: &quot;x 128 &lt; 0 255?&quot;. É traduzido como: &quot;(x &lt; 128)? 0 :
255&quot;.</span><br>
    * <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Levels(il, gamma, ih, ol, oh) (dê uma olhada no
filtro <a href="../../../../../Documents%20and%20Settings/Rotildo%20Longo/corefilters/levels.htm">Levels</a>):
il de &quot;x - il de ih - / gamma ^ oh ol - *&quot;. É traduzido como
&quot;(((x - il) / (ih - il)) ^ gamma) * (oh - ol)&quot;.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Padrões</span><span lang="EN-US" style="font-size:
10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
EN-US;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> são:</span> <var>Yexpr</var> = <var>Uexpr</var> = <var>Vexpr</var> =
&quot;x&quot; <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">(portanto, o filtro não faz nada).</span>
</p>
<h3><a name="maskedmerge"></a>MaskedMerge
</h3>
<p><code>MaskedMerge</code> (<var>base_clip, overlay_clip, mask_clip</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro aplica o clipe overlay_clip no
base_clip, considerando o clipe mask_clip. Mais precisamente, com bc, oc e mc os
valores de três píxeis assumidos base_clip, overlay_clip e mask_clip
respectivamente, o resultado será:</span>
</p>
<pre>v = ((256 - <i>mc</i>) * <i>bc</i> + <i>mc</i> * <i>oc</i> + 128) / 256</pre>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">128 está aqui para reduzir o erro devido ao
arredondamento da divisão de inteiro.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Assim, se a máscara for 255, o píxel será do <i>overlay_clip</i>,
se a máscara for 0, o píxel será do base_clip, e será misturado entre ambos
os clipes.</span>
</p>
<h3><a name="motionmask"></a>MotionMask
</h3>
<p><code>MotionMask</code> (<var>clip, int &quot;thY1&quot;, int &quot;thY2', int
&quot;thC1&quot;, int &quot;thC2&quot;, int &quot;thSD&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro cria uma máscara do movimento do
quadro. Como os outros filtros que criam máscaras, o movimento é computado, é
percentualizado por dois percentuais. Este filtro também conferirá mudança de
cena e se detectar uma, não produzirá nenhuma máscara.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A detecção de mudança de cena é feita
computando a soma de diferenças absolutas do quadro com o prévio. Esta soma é
pesada e comparada para <i>thSD</i>. Se for mais que <i>thSD</i>, uma mudança
de cena é detectada.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">O movimento é computado do mesmo modo como <a href="../../../../../Documents%20and%20Settings/Rotildo%20Longo/Meus%20documentos/nomosmooth.htm">NoMoSmooth</a>,
significando que para cada píxel, computaremos a soma absoluta das diferenças
entre o píxel e seu vizinho com o do quadro prévio. O valor resultante é
dividido por 9 para normalizar o resultado entre 0 e 255.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este algoritmo só dá uma aproximação do
movimento. Trabalhará bem nas extremidades de um objeto, mas não em seu
interior.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Padrões</span><span lang="EN-US" style="font-size:
10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
EN-US;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> são:</span> <var>thY1</var>= 20, <var>thY2</var> = 20, <var>thC1</var> =
10, <var>thC2</var> = 10 e <var>thSD</var> = 10.
</p>
<h3><a name="convolution"></a>YV12Convolution
</h3>
<p><code>YV12Convolution</code> (<var>clip, string &quot;horizontal&quot;, string
&quot;vertical&quot;, int &quot;total&quot;, bool &quot;automatic&quot;, bool
&quot;saturate&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro computa o produto de convolução
entre o quadro e o núcleo definido pela multiplicação do horizontal pelo
vertical. Estas duas strings representam vetores. Eles têm que ter um número
inteiro diferente ou números reais, separado por espaços únicos. <var>total <span style="font-style:normal"><font color="#000000">é
um fator de normalização que é dividido</font> <font color="#000000">pelo
resultado do produto. </font></span></var>Se <var>automatic</var> estiver fixado
em 'true', o total é a soma dos coeficientes da matriz. Significa que desse
jeito, o brilho global do quadro não é tocado. <var>Saturate<span style="font-style:
normal"> <font color="#000000">permite escolher o</font> <font color="#000000">comportamento
do filtro quando o resultado for um número negativo.</font></span></var></span>
</p>
<ul>
  <li><var>saturate</var> = true : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valores negativos são zerados.</span></li>
  <li><var>saturate</var> = false : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">valores negativos são invertidos.</span>&nbsp;</li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Se total não estiver definido, é fixado à soma
dos coeficientes do núcleo de convolução, permitindo assim uma boa normalização
para borrar / aguçar os núcleos.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Se um dos coeficientes horizontal ou vertical é
um real número, todas as computações serão feitas com flutuantes, assim o
filtro será mais lento.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Padrões</span><span lang="EN-US" style="font-size:
10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
EN-US;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA"> são:</span> <var>horizontal</var> = &quot;1 1 1", <var>vertical</var> = "1 1 1"
e <var>automatic</var> = false, <var>saturate</var> = true.
</p>
<h3><a name="subtract"></a>YV12Subtract
</h3>
<p><code>YV12Subtract</code> (<var>clip1, clip2, int tol, bool
&quot;widerange&quot;</var>)
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este filtro computa a diferença entre os dois
clipes. Há vários modos de computar esta diferença, dependendo dos valores de
<i><font color="#660033">widerange</font></i> e de <i><font color="#660033">tol</font></i>.</span>
</p>
<ul>
  <li><var>widerange</var> = true : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">nós computamos a diferença (n) entre os dois
    clipes e retornamos r = 128 + 128 * pow(n / 255,1 / <i><font color="#660033">tol</font></i>).
    Se <font color="#660033"><i>tol</i> </font>&lt; 0, 1 / <i><font color="#660033">tol</font></i>
    se torna 0.5.</span></li>
  <li><var>widerange</var> = false :
    <ul>
      <li><var>tol</var> &lt; 0 : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">nós computamos a diferença absoluta (n) entre os
        dois clipes e devolvemos r</span> = n / 2 + 128.</li>
      <li><var>tol</var> &gt;= 0 : <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">nós computamos a diferença absoluta (n) entre
        os dois clipes e devolvemos 0 se n é mais baixo que tol, senão n -
        tol.</span>&nbsp;</li>
    </ul>
  </li>
</ul>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Padrões</span><span lang="EN-US" style="font-size:
10.0pt;mso-bidi-font-size:12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:
&quot;Times New Roman&quot;;mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:
EN-US;mso-fareast-language:PT-BR;mso-bidi-language:AR-SA">  são</span>: <var>tol</var> = -1
e <var>widerange</var> = false.
</p>
<h2><a name="examples"></a>III) Alguns usos práticos (não testados extensivamente)
</h2>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Estes não produzirão os mesmos resultados
exatos como nos filtros originais que eles tentam imitar, além de serem mais
lentos. Apesar das numerosas funções adicionais, nenhuma idéia mais nova.</span>
</p>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Notas:</span>&nbsp;<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">- Eu estou com muita preguiça para atualizar a
sintaxe, especialmente considerando como mode=2 trabalha e como EdgeMask foi
atualizado (agora maiores necessidades de um Binarize por exemplo)</span><br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">- Alguns filtros eu descrevo como 'para criar' já
existe (imagereader, níveis para segurar,</span> ...).
</p>
<h4><a name="msharpen"></a>1) MSharpen
</h4>
<pre># <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Construa EdgeMask do clip1, Binarize isso e armazene o resultado no clip3</span>
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Aplique qualquer filtro aguçador ao clip1 e salve no clip2</span>
...
return MaskMerge(clip1, clip2, clip3)</pre>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">As extremidades aguçadas do clip2 maior que o
percentual dado a Binarize será aguçado e substituirá seu valor original no
clip1. Você também pode escrever um filtro com uma tabela particular (melhor
se parecer com um sino), substitua Binarize por ele e tenha um aguçar pesado,
dependendo do valor de extremidade: essa é a parte HiQ no SmartSmoothHiQ.</span>
</p>
<pre>clip2 = clip1.&lt;EdgeEnhancer&gt;(&lt;parameters&gt;)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Planos U e V não precisam filtragem, Y precisa</span>
# EdgeMask(&lt;...&gt;, &quot;roberts&quot;, Y=3, U=-128, V=-128) para mapa cinza
clip3 = clip1.EdgeMask(15, 60, &quot;roberts&quot;, Y=3, U=1, V=1)
return MaskedMerge(clip1, clip2, clip3)</pre>
<h4><a name="msoften"></a>2) MSoften
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Substitua EdgeEnhancer por um softener espacial
(borrado em cascata? spatialsoftenMMX?) e use upper=true para selecionar píxeis
planos próximos.</span>
</p>
<h4><a name="rainbow"></a>3) <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Redução de arco-íris (como descrito aqui neste</span><span style="font-size: 10.0pt; mso-bidi-font-size: 12.0pt; font-family: Microsoft Sans Serif; mso-fareast-font-family: Times New Roman; mso-bidi-font-family: Times New Roman; mso-ansi-language: PT-BR; mso-fareast-language: PT-BR; mso-bidi-language: AR-SA">
</span><a href="http://forum.doom9.org/showthread.php?s=&amp;threadid=48167"><cite>artigo</cite></a>
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Aviso, isto não é uma solução milagrosa</span>
</p>
<pre>clip2 = clip1 soften at maximum (using deen(&quot;m2d&quot;) or edeen for instance)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Pegue luma edgemap e aumente as extremidades com inflating</span>
# -&gt; <span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">áreas mais largas a serem processadas</span>
clip3 = clip1.EdgeMask(6, &quot;roberts&quot;, Y=3, U=1, V=1).Inflate(Y=3, U=1, V=1)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Agora, use luma edgemask como máscara de croma</span>
clip3 = YtoUV(clip3, clip3).ReduceBy2().Binarize(15, upper=false, Y=1, U=3, V=3)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Nós temos que processar píxeis croma próximos das extremidades, mas manter intato o plano Y</span>
return MaskedMerge(clip1, clip2, clip3, Y=1, U=3, V=3)</pre>
<h4><a name="fxtoon"></a>4) Super amostragem de fxtoon
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Não testado</span>
</p>
<pre>. <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Use tweak para escurecer o quadro ou fazer um plugin que reduz valores de Y - &gt; clip2</span>
. <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Construa máscara de extremidade, Supersample esta máscara, Binarize isto com um alto percentual (segurando melhor o som), Inflate - &gt; clip3</span>
. <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Aplique os píxeis mais escuros de clip2 que dependem dos valores de clip3</span></pre>
<h4><a name="warpsharp"></a>5) Warpsharp para luma escura
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Não testado</span>
</p>
<pre>. <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Aplique warpsharp - &gt; clip2 (píxeis de substituição)</span>
. <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Crie um filtro segurando ou um de contorno baixo luma - &gt; clip3 (máscara)</span></pre>
<h4><a name="deinterlacer"></a>6) pseudo-desentrelaçador (croma continua
problemático)
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Não testado</span>
</p>
<pre>clip2 = clip1.SeparateFields().SelectEven().&lt;Method&gt;Resize(&lt;parameters&gt;)
clip3 = clip1.&lt;CombingDetector&gt;(&lt;parâmetros&gt;)
return MaskedMerge(clip1, clip2, clip3, Y=3, U=3, V=3)</pre>
<p>(<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">croma até mais problemático</span>)
</p>
<h4><a name="rect_overlay"></a>7) Sobreposições não retangulares
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Na realidade, isto é controlado melhor por
camada e máscara</span>...
</p>
<pre># <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Simples corte porque ImageReader precisa de um fps inteiro</span>...
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A maioria das fontes é nativa em YUY2/YV12</span>
clip = AviSsource(&quot;test.avi&quot;).ConvertToYV12().assumefps(fps)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Carregue o quadro para ser sobreposto</span>
image = ImageReader(&quot;mask.bmp&quot;, 0, clip.framecount()-1, 24, use_DevIl=false)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Modo simples: assumir preto é transparente</span>&nbsp;
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Qualquer outra cor seria bem mais complicado *</span>
masktemp = imageYV12.Binarize(17, upper=false, Y=3)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Nós fixamos a máscara luma para ajustar os planos croma</span>
mask = Mask.FitY2UV()
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Agora que nós temos a máscara que nos conta o que queremos manter...</span>
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Substitua por imagem as partes do clipe mascarado por mask!</span>
MaskedMerge(clip, image, mask, Y=3, U=3, V=3)
# * <span lang="EN-US" style="font-size:10.0pt;mso-bidi-font-size:
12.0pt;font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:EN-US;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">solução: mask = OverlayMask(image, image.BlankClip ($xxxxxx &quot;), 1, 1)</span></pre>
<h4><a name="backgournd"></a>8) Substituir fundos
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este exemplo fica claramente melhor em RGB. Para
evitar problemas típicos devido a ruído ou compressão, você usa melhor versões
borradas do clipe e quadro.</span>
</p>
<pre>source = AviSource(&quot;overlay.avi&quot;).AssumeFPS(24)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">borre a fonte</span>
clip = source.Blur(1.58).Blur(1.58).Blur(1.58)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">carregue o fundo para substituir, capturado da seqüência borrada,</span>
bgnd = ImageReader(&quot;bgnd.ebmp&quot;, 0, clip.framecount()-1, 24, use_DevIl=false)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">carregue novo fundo</span>
new = ImageReader(&quot;new.ebmp&quot;, 0, clip.framecount()-1, 24, use_DevIl=false)
# <span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">filtro integrado para produzir a máscara = (clip~overlay?)</span>
mask = OverlayMask(clip, overlay.ConvertToYV12(), 10, 10)
MaskedMerge(source, new.ConvertToYV12(), mask, Y=3, U=3, V=3)</pre>
<h4><a name="mftoon"></a>9) K-mfToon
</h4>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Eu preciso incluir mais info (urls/posts
original) mas por ora eu penso que o autor do mfToon, mf (mf@onthanet.net)
original não reagirá muito violentamente a isto, enquanto ainda não está
enviado.</span><br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">A produção da função no K-mfToon.avs deve ser
idêntica à do mftoon.avs original (também incluída), com duas vezes a
velocidade.</span><br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">As exigências são:</span><br>
- Para mfToon:<br>
  . carregar os plugins "MaskTools", "warsharp", "awarsharp"&nbsp;
</p>
<h2><a name="todo"></a>IV) TODO - a ser feito
</h2>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Nada, tudo depende de avaliação.</span><br>
</p>
<h2><a name="disclaimer"></a>V) Retratação
</h2>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Este plugin é liberado sob a licença GPL. Você
tem que aceitar as condições em 'Copying.txt' antes de usar o plugin ou seu código
fonte.</span><br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Você fica avisado também para usar isto em um
estado de mente filantrópica, ou seja, &quot;eu não manterei este segredo só
para mim&quot;.</span><br>
<br>
<span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Último mas não menos, uma muito pequena parte
de todos os possíveis usos de cada filtro foi testada (talvez 5% - ainda um par
de horas gasto para depurar). Então, avaliação é <b>muito_ bem vinda</b> (o
oposto, falta de avaliação - também é verdade...)</span>
</p>
<h2><a name="revisions"></a>VI) Revisões
</h2>
<p>1.5.1
</p>
<ul>
  <li>Complete rewritting of the documentation ( a huge thanks to Wilbert ).</li>
  <li>DEdgeMask now supports a float divisor. However, if the divisor is integer, it *should* be faster.</li>
  <li>DEdgeMask now has back its parameter "setdivisor", but it's only for backward compatibility with some scripts.</li>
  <li>YV12LUTxy : it's a new filter, implementing the idea presented by Didee on the previous post. The "y" symbol has the value of the collocated pixel in the second clip.</li>
</ul>
<p>1.4.16
</p>
<ul>
  <li>Bugfixes : Logic "min" &amp; "max" modes weren't properly working, it's corrected.</li>
  <li>Bugfixes : Logic &amp; Subtract weren't using MMX &amp; iSSE optimizations, due to a very silly bug.
    It's Corrected.</li>
</ul>
<p>1.4.15.3</p>
<ul>
  <li>RGBLUT added : works the same as YV12LUT ( except R, G and B replace Y, U and V ).</li>
  <li>In addition, you can specify an AMP file ( arbitrary color mapping file format from photoshop ).</li>
</ul>
<p>1.4.15.2</p>
<ul>
  <li>Bug finally solved on YV12LUT. Silly programming bug, as always...</li>
  <li>In YV12LUT, logical and relationnal operators added ( &lt;, &lt;=, >, >=, ==, !=, &amp;, !&amp;, |, ° ( xor ) )</li>
  <li>In YV12LUT, a ternary operator added : ? ( works as in C )</li>
</ul>
<p>1.4.15.1</p>
<ul>
  <li>In YV12LUT, another bug which was still preventing it from working fine. Hopefully, it should
    really work now.</li>
</ul>
<p>1.4.15</p>
<ul>
  <li>New Filter : HysteresyMask. It will allow you to build a new edge mask from two edge masks,
    one only having a few edges ( but we're sure they indeed are edges ), the other having two
    much edges ( due to a too low thresholding for example ). Look in the documentation to have
    further explanations.</li>
</ul>
<p>1.4.14.2</p>
<ul>
  <li>Several bugfixes concerning the behavior of negative values for Y, U and V ( edgemask,
    dedgemask, motionmask, combmask, logic )</li>
  <li>Several bugfixes concerning the use of offX / offY / w and h ( filters than can use it are :
    maskedmerge, binarize, expand, YV12subtract, yv12lut )</li>
  <li>In YV12LUT, a bug prevented to use it with some filter. It should work now.</li>
  <li>In YV12Convolution, float coefficients can be used now. If none is used, all the processing
    will take place with integer, so it will be faster than if you use a float. Moreover, if<br>
    there is the possibility of overflow ( giving a result over 255 or under 0 ) during computation,
    a slower but safe function will be used to saturate computation to 0 and 255.</li>
</ul>
<p>1.4.14.1</p>
<ul>
  <li>Bugfix in YV12LUT to allow the use of negative numbers</li>
</ul>
<p>1.4.14</p>
<ul>
  <li>Bugfix : In YV12Layer, a useless test could prevent the filter to work. The test has been
    removed</li>
  <li>Bugfix : In DEdgeMask, threshold weren't taken into account. They are now</li>
  <li>Bugfix : Logic filter is now fully functionnal, in C and MMX</li>
  <li>Added : documentation to Logic filter</li>
  <li>Added : two modes for Logic : "Min" and "Max" ( C, MMX, iSSE )</li>
  <li>Added : In DEdgeMask, the possibility to set the normalization factor</li>
  <li>Corrected : documentation.</li>
</ul>
<p>1.4.13</p>
<ul>
  <li>Bugfix : One more, in the MotionMask ( the last row was not correctly computed )</li>
  <li>Optimizations : MaskedMerge gives now the same output in MMX and C, so MMX optimizations
    for it are back by default.</li>
  <li>Added : In EdgeMask, you now can use the laplace kernel. See the documentation on that
    filter</li>
  <li>Added : 'New' filter, DEdgeMask, which allows you to choose your kernel ( at a cost :&nbsp;
    speed )</li>
</ul>
<p>1.4.12</p>
<ul>
  <li>Behavior modifications : MotionMask and EdgeMask now also computes pixels on the borders
    mainly by extending the mask to these pixels.</li>
  <li>Bugfix : Inflate / Inpand / Expand / Deflate, when using negative parameters for y,u and v,&nbsp;
    some weird problems could occur.</li>
  <li>Added functionnality : In YV12LUT, the function abs is now defined.</li>
</ul>
<p>1.4.11</p>
<ul>
  <li>Bugfix : EdgeMask, MMX optimizations give different results. They are disabled by default.
    To activate them, use usemmx = true. They'll be used only with mod 16 resolution</li>
  <li>Bugfix : EdgeMask : first and last lines weren't always computed.&nbsp;</li>
  <li>Bugfix : MaskedMerge : MMX optimizations darken slightly the picture. They are disabled by
    default. To activate them, use usemmx = true. They'll be used only with mod 16 resolution.</li>
</ul>
<p>1.4.10</p>
<ul>
  <li>Bugfix : first and last lines were not correctly computed with inflate / deflate</li>
  <li>Invert is no longer a filter of the Masktools, it has been moved inside AviSynth.</li>
</ul>
<p>1.4.9</p>
<ul>
  <li>New filter : CombMask. As usual, read further for more documentation</li>
</ul>
<p>1.4.8</p>
<ul>
  <li>YV12Convolution now supports negative coefficients in the matrix. It allows to use the
    filter has an edge detecter.</li>
  <li>YV12Convolution has now a new parameter : bool saturate, which, if set to true,&nbsp;
    or if there is a possibility of getting out of the range [0..255] during calculation,
    clips each pixel into that range ( which means it's slightly slower )</li>
  <li>A new filter : LUT. Read further for more information on how to use it.</li>
</ul>
<p>1.4.7</p>
<ul>
  <li>Rename MotionDetection to MotionMask. I know it's kind of silly, but it's a lot
    more logical that way.</li>
  <li>Add the check of the width for the use MMX in MotionMask</li>
  <li>Slightly modify MMX optimizations in Binarize.</li>
  <li>Add a new filter : YV12Convolution. It allows you to convole the picture by
    a matrix of (almost) any size. Look further in the readme to learn how to use it</li>
</ul>
<p>1.4.6</p>
<ul>
  <li>Made the scenechange detection in MotionDetection iSSE optimized ( meaning you
    need an Athlon XP / Pentium IV ). It works with an Athlon XP, it is not tested with<br>
    an Pentium IV, it is possible to disable it by using usemmx = false in the paremeters
    of the filter.</li>
  <li>Optimized the calculation of the motion, without using MMX ( just by avoiding to do&nbsp;
    3 times the same calculations... ). So the filter should be more or less three times
    faster.</li>
</ul>
<p>1.4.5</p>
<ul>
  <li>Added MotionDetection filter, no MMX / assembler optimizations for it yet. Look
    further in the Readme to learn how to use it. It takes the idea of Sansgrip's filter
    (NoMoSmooth) and outputs the motion mask directly in the correct colorspace for the
    MaskTools.</li>
</ul>
<p>1.4.4</p>
<ul>
  <li>Reactivated MMX optimizations for MaskedMerge</li>
  <li>Came back to Kurosu's optimizations for Invert</li>
</ul>
<p>1.4.3</p>
<ul>
  <li>Made some MMX optimizations ( binarize, invert )</li>
  <li>Corrected some MMX optimizations ( which means mostly 'disabled some MMX optimizations' ). It should now work with P4.</li>
</ul>
<p>1.4.2</p>
<ul>
  <li>Fixed bugs concerning the inpand / expand / inflate / deflate functions</li>
</ul>
<p>1.4.1
</p>
<ul>
  <li>Fixed the dreadly bug "multiple instances of a filter with different functions needed"</li>
</ul>
<p>1.4.0
</p>
<ul>
  <li>Added an experimental LUT filter. Not tested, debug later.</li>
</ul>
<p>1.3.0 (private version)
</p>
<ul>
  <li>Made usable the FitPlane function (still an overload of work when only one plane has to be resized) which was previously undocumented;
therefore, added FastFitPlane functions (corresponding FitPlane ones should be useless now, except for the resizers settings)</li>
  <li>Allowed the specification of a processing area for many filters; however, this should not produce any noticable speed increase.</li>
  <li>Cleaned YV12Layer (in particular the unusable "Darken"/"Lighten" modes)</li>
  <li>Added OverlayMask, a function that compares 2 clips, and outputs a mask of the parts that are identical (slow and far from perfect).</li>
</ul>
<p>1.2.0 (private version)
</p>
<ul>
  <li>YV12Layer: no more useless RGB32 conversion! Approximately the same as Arithmetic (except a third clip is not used), so that one is gone...</li>
  <li>YV12Substract: hey, why only a C version? Masks are really an underused feature of AviSynth |-[</li>
</ul>
<p>1.1.0 (private version)
</p>
<ul>
  <li>Older inflate/deflate are renamed expand/inpand while newer functions replace them</li>
  <li>Logic and Arithmetic functions added (shouldn't produce the expected results because of no debugging)</li>
  <li>Edgemask now takes 4 thresholds (2 for luma and 2 for chroma). They are used for:
    setting to 0 or leaving as is a value depending on first threshold,&nbsp; setting to 255 or leaving as is a value depending on the second one.</li>
</ul>
<p>1.0.2 (last version - public project dropped):
</p>
<ul>
  <li>Fix the shift for edgemask using sobel and roberts (misplaced MMX instruction)</li>
  <li>MaskMerge now works (mask cleared before being used... check with MaskMerge(clip3,clip3) for instance)</li>
</ul>
<p>1.0.1: Initial release
</p>
<h2><a name="developer"></a>VII) Os Ensaios do Desenvolvedor
</h2>
<p><span style="font-size:10.0pt;mso-bidi-font-size:12.0pt;
font-family:&quot;Microsoft Sans Serif&quot;;mso-fareast-font-family:&quot;Times New Roman&quot;;
mso-bidi-font-family:&quot;Times New Roman&quot;;mso-ansi-language:PT-BR;mso-fareast-language:
PT-BR;mso-bidi-language:AR-SA">Volte ao V) se você não está interessado em
desenvolver as ferramentas disponíveis.</span><br>
<br>
The project is a VC++ 6 basic project. Each filter has its own folder which stores the header used by the interface, the source for the function
members, the source for processing functions and its header. Let's look at EdgeMask:<br>
- EdgeMask.h is included by the interface to know what the filter 'looks like' (but interface.cpp still holds the definition of the
calling conventions and exported functions)<br>
- EM_func.h describes the different processing functions (they should all have the same prototype/parameters):<br>
  . Line_MMX and Line_C<br>
  . Roberts_MMX and Roberts_C<br>
  . Sobel_MMX and Sobel_C<br>
- EM_func.cpp, as all &lt;filter's initials>_func.cpp, stores the implementation of the processing functions, and sometimes their MMX
equivalents.<br>
- EdgeMask.cpp implements the class; the constructor select the appropriate processing function (MMX? C? Roberts? Line? Sobel?) and uses
it to fill the generic protected function pointer used in GetFrame<br>
<br>
Interface.cpp stores the export function and all of the calling functions (AVSValue ... Create_&lt;filter>).<br>
<br>
ChannelMode.cpp defines the Channel operating modes. There could be added the equivalent of a debugprintf.<br>
<br>
This quick walkthrough won't probably help most developers, as the examples of V) for users, but that's the best I've come with so far. It will improve
of course over time depending on the success of the idea, which main drawback, speed, will probably make it scarcely used, if ever. &lt;g>
</p>
<p><kbd>$Date: 2006/03/26 18:11:53 $ Portuguese translation by RoLon</kbd>
</p>
</body>
</html>
