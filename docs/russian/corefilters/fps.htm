<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="ru"><head>
<meta http-equiv="Content-Language" content="ru">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">

<title>Фильтры AviSynth AssumeFPS / ChangeFPS / ConvertFPS</title><link rel="stylesheet" type="text/css" href="../../avisynth.css"><!--
Automatically generated, don't change:
$Id: fps.htm,v 1.6 2007/01/03 19:18:08 fizick Exp $
--></head>

<body>
<h2><a name="AssumeFPS"></a>AssumeFPS</h2>
<p><code>AssumeFPS </code>(<var>clip, float fps, bool "sync_audio"</var>)<br>
   <code>AssumeFPS </code>(<var>clip, int numerator [, int denominator], bool "sync_audio"</var>)<br>
   <code>AssumeFPS </code>(<var>clip1, clip2, bool "sync_audio"</var>)<br>
   <code>AssumeFPS </code>(<var>clip, string preset, bool &quot;sync_audio&quot;</var>)</p>
<p>Фильтр <code>AssumeFPS</code> изменяет частоту кадров без изменения их числа
  (в результате видео воспроизводится быстрее или медленнее).
  Он устанавливает только параметр частоты кадров.<br>
  Если <var>sync_audio</var> - true (истина), то в той же степени изменяется и частота аудио-отсчетов,
  сдвигая высоту результирующего звука.</p>
<p>Это так же метод изменить только одну частоту аудио-отсчетов.</p>
<p> В <em>v2.55</em>, если указан <var>clip2</var>, частота кадров клипа <var>clip1</var>
будет подстроена для совпадения с частотой клипа <var>clip2</var>. Это полезно когда вы желаете
сложить (склеить) два клипа с немного различной частотой кадров.</p>
<p>В <em>v2.57</em>, поведение в отношении частоты кадров немного изменено. 
Главный вопрос в том, что пользователям разрешено указывать частоту кадров вещественной
(десятичной дробью), а NTSC (FILM и Video) и PAL стандарты требуют отношение в качестве частоты кадров. 
Кроме того, AviSynth экспортирует частоту кадров как отношение, так что когда указана
десятичная дробь, она будет преобразована в отношение. Отношения в стандартах
даны как 24000/1001 для 23.976 (FILM) и 30000/1001 для 29.97 (Video). <b>При указании
этих десятичных дробей, они экспортируются из AviSynth как отношения, но не как
стандартные отношения.</b> Одна из причин этого то, что эти десятичные дроби
являются приближенными (помните что 24000/1001 = 23.9760239760...), так что как бы
AviSynth знал, как выбрать корректное отношение? Чтобы преодолеть эту проблему,
пользователь может использовать AssumeFPS(24000,1001) или просто
AssumeFPS(&quot;ntsc_film&quot;). </p>
<p>Другой  проблема в том, что преобразованные десятичные дроби были (в v2.56 и ранее)
экспортированы с 64 битной точностью, приводя к очень большим числителям и знаменателям,
приводя некоторые проигрыватели к отказу. Чтобы преодолеть это, разумное вещественное-в<span lang="en-us">-</span>отношение
преобразование добавлено внутренне, и теперь частоты кадров аккуратно аппроксимируются отношениями
малых чисел. Например, AssumeFPS(23.976) теперь превращается в
AssumeFPS(2997,125) что может быть проверено с <a href="info.htm">Info</a>. </p>
<p><b>Синонимы (Presets):</b> </p>
<table border="1" width="66%">
  <tr>
    <td width="33%" align="center"><b>стандарт</b></td>
    <td width="33%" align="center"><b>числитель (numerator)</b></td>
    <td width="34%" align="center"><b>знаменатель (denominator)</b></td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_film"</td>
    <td width="33%" align="center">24000</td>
    <td width="34%" align="center">1001</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_video"&nbsp;</td>
    <td width="33%" align="center">30000</td>
    <td width="34%" align="center">1001</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_double"</td>
    <td width="33%" align="center">60000</td>
    <td width="34%" align="center">1001</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_quad"</td>
    <td width="33%" align="center">120000</td>
    <td width="34%" align="center">1001</td>
  </tr>
  <tr>
    <td width="33%" align="center">&quot;ntsc_round_film&quot;</td>
    <td width="33%" align="center">2997</td>
    <td width="34%" align="center">125</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_round_video"</td>
    <td width="33%" align="center">2997</td>
    <td width="34%" align="center">100</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_round_double"</td>
    <td width="33%" align="center">2997</td>
    <td width="34%" align="center">50</td>
  </tr>
  <tr>
    <td width="33%" align="center">"ntsc_round_quad"</td>
    <td width="33%" align="center">2997</td>
    <td width="34%" align="center">25</td>
  </tr>
  <tr>
    <td width="33%" align="center">"film"</td>
    <td width="33%" align="center">24</td>
    <td width="34%" align="center">1</td>
  </tr>
  <tr>
    <td width="33%" align="center">"pal_film"</td>
    <td width="33%" align="center">25</td>
    <td width="34%" align="center">1</td>
  </tr>
  <tr>
    <td width="33%" align="center">"pal_video"</td>
    <td width="33%" align="center">25</td>
    <td width="34%" align="center">1</td>
  </tr>
  <tr>
    <td width="33%" align="center">"pal_double"</td>
    <td width="33%" align="center">50</td>
    <td width="34%" align="center">1</td>
  </tr>
  <tr>
    <td width="33%" align="center">"pal_quad"</td>
    <td width="33%" align="center">100</td>
    <td width="34%" align="center">1</td>
  </tr>
</table>
<p> <b>Примеры преобразования PAL +4% Telecine :</b></p>
<pre>AVISource("FILM_clip.avi") # получить клип 24 к/с.
LanczosResize(768,576)     # Изменить размер к размеру кадра PAL с квадратными пикселами.
AssumeFPS(25, 1, true)     # Изменить частоту кадров к PAL, так же подстроить аудио.
SSRC(44100)                # Восстановить частоту аудио-отсчетов к стандартному значению.</pre>
<p>+4% ускорение обычно применяется для отображения фильма с 24fps на PAL телевидении.
Небольшое увеличение частоты и темпа с готовностью принимается смотрящими материалы PAL.</p>

<h2><a name="ChangeFPS"></a>ChangeFPS</h2>
<p><code>ChangeFPS </code>(<var>clip, float fps, bool "linear"</var>)<br>
   <code>ChangeFPS </code>(<var>clip, int numerator [, int denominator], bool "linear"</var>)<br>
   <code>ChangeFPS </code>(<var>clip1, clip2, bool "linear"</var>)<br>
   <code>ChangeFPS </code>(<var>clip, string preset, bool &quot;linear&quot;</var>)</p>
<p><tt><code>ChangeFPS</code></tt> изменяет частоту кадров удалением или копированием кадров.</p>

<p>До <em>v2.05</em>, видео урезалось или дополнялось для сохранения скорости и времени
  воспроизведения (число кадров не менялось). В более поздних версиях, поведение было изменено
  и число кадров увеличивается или уменьшается как в <code>ConvertFPS</code>.</p>
<p>В <em>v2.54</em>, к <code>Changefps</code> добавлена опция <var>linear</var> = true/false.
  Она заставит AviSynth запрашивать кадры в линейной&nbsp;форме (манере), когда кадры пропускаются. Значение по умолчанию
  true.
</p><p> В <em>v2.56</em>, если присутствует <var>clip2</var>, частота кадров клипа <var>clip1</var>
будет подстроена в соответствии с частотой клипа <var>clip2</var>.</p>
<p> В <em>v2.57</em>, поведение в отношении частоты кадров немного изменено. Смотри AssumeFPS.</p>
<p> <b>Пример преобразования PAL-&gt;NTSC:</b></p>
<pre>AVISource("PAL_clip.avi")        # Получить клип.
Bob(height=480)                  # Разделить поля и интерполировать их к полной высоте.
BicubicResize(640,480)           # Изменить размер к NTSC с квадратными пикселами.
ChangeFPS(60000, 1001)           # Преобразовать частоту полей к NTSC их дублированием.
SeparateFields.SelectEvery(4,0,3)# Отменить Bob, четное поле первым. SelectEvery(4,1,2) для нечетного первого поля.
Weave                            # Закончить отмену Bob.</pre>
<p>Эффект аналогичен 3-2 telecine pull down. Постоянные зрители PAL материалов могут заметить
подрагивание движения, которое зрители NTSC материалов легко игнорируют как и для
обработанного по принципу telecine фильма.</p>

<h2><a name="ConvertFPS"></a>ConvertFPS
</h2>
<p><code>ConvertFPS </code>(<var>clip, float new_rate, int "zone", int "vbi"</var>)<br>
   <code>ConvertFPS </code>(<var>clip, int numerator [, int denominator], int "zone", int "vbi"</var>)<br>
   <code>ConvertFPS </code>(<var>clip1, clip2, int "zone", int "vbi"</var>)<br>
   <code>ConvertFPS </code>(<var>clip, string preset, int &quot;zone&quot;, int &quot;vbi&quot;</var>)</p>
<p> Фильтр делает попытку преобразовать частоту кадров клипа <var>clip</var> к значению <var>new_rate</var>
  без выкидывания или вставки кадров, предлагая плавное преобразование с результатом,
  аналогичным автономным преобразовательным устройствам. Выход будет (почти) той-же длительности, как
  и <i>clip</i>, но число кадров изменится пропорционально
  соотношению целевой и исходной частот кадров. </p>
<p> В <em>v2.56</em>, если присутствует <var>clip2</var>, частота кадров клипа <var>clip1</var>
будет подстроена в соответствии с частотой клипа <var>clip2</var>.</p>
<p> В <em>v2.57</em>, поведение в отношении частоты кадров немного изменено. Смотри AssumeFPS.</p>
<p> Фильтр имеет два режима действия. Если отсутствует опциональный аргумент <var>zone</var>,
  он взвешенно смешивает (blend) смежные видео-кадры с коэффициентом смешивания
  пропорциональным относительному хронометражу кадров ("Режим смешивания", blend mode). Если <var>zone</var> 
  присутствует, он переключится с одного видео-кадра к следующему ("Режим переключения", switch mode) всякий
  раз, когда начинается новый кадр источника, т.е., обычно где-то в середине целевого кадра.
  Режим переключения предполагает, что результат будет показан на TV где каждый кадр сканируется 
  сверху вниз. Параметр <var>zone</var> определяет высоту переходной области в которой текущий 
  кадр будет подвергнут смешению со следующим. </p>
<p> Режим смешивания вызовет заметное, хотя и слабое, размытие движения. Это
  - типичный артефакт преобразования частоты кадров, и также может быть виден на 
  коммерческих видео-кассетах и в телевизионных программах. При работе с чересстрочным видео,
  важно позволить фильтру работать на отдельных полях, но не на чересстрочных кадрах.
  (См. пример внизу) </p>
<p> Режим переключения - это попытка избежать размытия движения, но это достигается ценой
  небольшого мерцания и артефактов движения. Горизонтальное и вертикальное панорамирование
  может показать небольшое дрожание. Ещё кадры при таком преобразовании показывают "ломаные"
  или "кривые" вертикальные линии в сценах с движением. Переход от сцены к сцене может произойти
  в середине кадра. Тем не менее, результат выглядит менее размытым, чем в "Режиме смешивания".</p>
<p> Ни один из режимов не идеален. Какой из них выбрать, зависит от личных предпочтений
  и от отснятого материала, предназначенного к преобразования. Режим переключения вероятно подходит только, если выход будет показан на TV, но не на экране компьютера.</p>
<p> Преобразование частоты кадров по сути сложно. Этот фильтр реализует два обычных
  способа, используемых коммерческими,&nbsp; полу-профессионального (Prosumer) уровня
системами преобразования. Результат обычно вполне хорош. Более сложные
системы включают алгоритмы интерполяции движения, что сложно получить
правильно, но, если сделано верно, приводит к результатам высшего
качества.</p>

<p> Отснятый материал, преобразованный этим фильтром, не должен быть преобразованным вновь.
  Размытость нарастает быстро при последовательных преобразованиях. </p>

<p> Аудио-данные не затрагиваются этим фильтром. Звук остаётся синхронизированным, 
  хотя длина аудио-данных может немного отличаться от видео-данных после преобразования.
  Это из-за того, что выход может содержать только целое число кадров. Этот эффект более 
  заметен для коротких клипов. Различие в длине должно быть проигнорировано. </p>
<p>Параметры:
<table>
  <tbody>
  <tr valign="top">
    <td width="80"><i>new_rate</i></td>
    <td>Целевая частота кадров. Может быть целым, или числом с плавающей точкой.
      В Режиме Смешивания <i>new_rate</i> должна быть как минимум 2/3 (66.7%) от частоты кадров источника,
      или произойдет ошибка. Это сделано для предотвращения пропуска кадров. Если вам надо
      замедлить частоту кадров более этого, используйте Режим Переключения. </td>
  </tr>
  <tr valign="top">
    <td>zone</td>
    <td>(Опциональный) Если указан, переводит фильтр в Режим Переключения. Целое число
      более или равное нулю. Если 0, фильтр предпримет жёсткое переключение, т.е., немедленно покажет
      следующий кадр ниже линии переключения. Если больше нуля, указывает высоту (в линиях)
      области перехода, где один кадр плавно переходит в другой. zone=80 производит
      хороший результат для полноразмерного видео (480/576 активных линий). Переход делается
      таким же образом, как и в PeculiarBlend(). <i>zone</i> должен быть менее либо равным числу
      линий целевого кадра. Это обычно 5/6 или 6/5 высоты целевого кадра, т.е., несколько сотен линий. 
      Произойдет ошибка, если выберется большее значение. </td>
  </tr>
  <tr valign="top">
    <td><i>vbi</i></td>
    <td>(Опциональный) В режиме Переключения, указывает что фильтр должен осуществлять коррекцию
      хронометража для вертикального интервала гашения (Vertical Blanking Interval). Целое число
      больше нуля, показывает высоту VBI целевого кадра, в линиях. Обычно vbi=49 для PAL и VBI=45
      для NTSC, но эти значения не критичны. Игнорируется в Режиме Смешивания. </td>
  </tr>
  </tbody>
</table>
</p><p> <b>Пример преобразования NTSC-&gt;PAL:</b></p>
<pre>AVISource("NTSC_clip.avi")       # Получить клип
Bob(height=576)                  # Разделить поля и интерполировать их к полной высоте.
BicubicResize(768,576)           # Изменить размер к PAL с квадратными пикселами. (Используйте 720,576 для CCIR.)
ConvertFPS(50)                   # Преобразовать частоту кадров к PAL, используя Режим Смешивания.
SeparateFields.SelectEvery(4,0,3)# Отменить Bob, четное поле первым. SelectEvery(4,1,2) для нечетного первого поля.
Weave                            # Закончить отмену Bob.</pre>
<p> Этот пример также работает с основанным на кадрах NTSC материалом, даже с фильмами 
(кинокартинами), обработанными по принципу telecine. Для кинофильмов, однако, вы получите
лучшие результаты, используя фильтр обратного telecine и ускоряя частоту кадров с 23.976 до 25fps.</p>
<p> Не все значения параметров проверяются на осмысленность.</p>
<p> <b>Изменения:</b> </p>
<table border="1" width="50%">
  <tr>
    <td width="25%"> v2.57</td>
    <td width="50%"> добавлена опция preset; изменено поведение частоты кадров; YV12 и
      RGB поддежка для ConvertFPS, исправлен фактор смешивания</td>
  </tr>
  <tr>
    <td width="25%"> v2.56</td>
    <td width="50%"> добавлена опция clip2 в ChangeFPS, добавлена AssumeScaledFPS</td>
  </tr>
  <tr>
    <td width="25%"> v2.55</td>
    <td width="50%"> добавлена опция clip2 в AssumeFPS</td>
  </tr>
  <tr>
    <td width="25%"> v2.54</td>
    <td width="50%"> добавлена linear=true/false к ChangeFPS</td>
  </tr>
</table>
<p><kbd>$English Date: 2006/12/06 20:33:16 $<br>
Русский перевод 26.05.2005 mitra anime@mdv.vrn.ru<br>
Дополнения 10.04.2006-06.12.2006 Fizick http://avisynth.org.ru</kbd></p>
<form>
  <input value="Back" onclick="history.go(-1)" type="button">
</form>
</body></html>