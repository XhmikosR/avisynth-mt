<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html lang="ru">
<head>
  <meta http-equiv="Content-Language" content="ru">
  <meta http-equiv="Content-Type"
 content="text/html; charset=windows-1251">
   <title>TimeStretch Filter</title>
   <link rel="stylesheet" type="text/css" href="../../avisynth.css">
<!--
Automatically generated, don't change:
$Id: timestretch.htm,v 1.4 2008/09/08 16:43:48 fizick Exp $
-->
</head>
<body >
<h2>
<a name="TimeStretch"></a>TimeStretch
</h2>
<p><code>TimeStretch </code>(<var>clip, float &quot;tempo&quot;, float &quot;rate&quot;,
float &quot;pitch&quot;, int &quot;sequence&quot;, int &quot;seekwindow&quot;,
int &quot;overlap&quot;, bool &quot;quickseek&quot;, int &quot;aa&quot;</var>)

<p><code>TimeStretch</code> позволяет изменять темп <var>tempo</var>, 
тональность <var>pitch<span lang="en-us"> </span></var>и скорость воспроизведения <var>rate</var>  звука независимо один от другого, т.е.:</p>
<ul>
  <li> <var>tempo</var> (темп) звука может увеличиваться и уменьшаться при поддержании
    исходной тональности звука.
  <li> <var>pitch</var> (тональность) звука может увеличиваться и уменьшаться при поддержании
    неизменного темпа.
  <li>Изменение параметра <var>rate</var> (скорость) воспроизведения приводит к одновременному
    изменению и темпа и тональности звучания.
  <li>Можно выбрать любые комбинации параметров tempo/pitch/rate.</li>
</ul>
<p><b>Параметры:</b></p>
<p>Параметры скорости задаются в процентах и по умолчанию равны 100. Если <var>tempo</var> задать
200, это приведет к ускоренному вдвое воспроизведению, если же <var>tempo</var> 50, воспроизведение замедлится вдвое.
Регулировка параметра <var>rate</var> эквивалентна использованию команд <a href="assumerate.htm">AssumeSampleRate</a>
и <a href="resampleaudio.htm">ResampleAudio</a>.</p>


<p>Алгоритм time-stretch (растяжения во времени) имеет несколько
параметров, подбирая которые можно оптимизировать качество звука под 
определенные приложения. Текущие параметры по умолчанию должны подбираться
методом итерационного анализа "если-то" (читай: "методом проб и ошибок")
с целью достижения лучшего субъективного качества звучания при обработке 
поп/рок музыки, но в прикладной обработке звука различного вида
установки параметров по умолчанию могут дать не совсем 
оптимальный результат.</p>
<p>Значения параметров по умолчанию time-stretch алгоритма:</p>
<blockquote>
  <pre>Sequence     82
SeekWindow   28
Overlap      12</pre>
</blockquote>
<p>Влияние этих параметров таково:</p>
<ul>
  <li><var>Sequence</var>: Это длина единичной обрабатываемой последовательности
  в миллисекундах, которая определяет, как исходный звук нарезается в
  time-stretch алгоритме. БОльшие значения дают меньшее количество 
  последовательностей при обработке. В принципе бОльшие значения лучше при
  замедлении темпа звука, и наоборот хуже при увеличении.<br>
  </li>
  <li><var>SeekWindow</var>: Длительность окна поиска в миллисекундах для алгоритма, 
  который ищет лучшее возможное положение мест перекрытия. Параметр определяет
  начальную ширину окна выборки, используемого алгоритмом для нахождения
  оптимального положения мест перекрытия при объединении последовательностей.<br>
  <br>
  Чем больше значение длительности окна, тем выше возможность нахождения
  лучшего положения мест перекрытия, но в тоже время больше и вероятность
  артефактов "дрейфа" (плавания) звука из-за отбора соседних последовательностей 
  более неровными интервалами. Если эти артефакты раздражают - звуки постоянной частоты
  как бы дрейфуют относительно своего значения, попробуйте уменьшить это значение.<br>
  </li>
  <li><var>Overlap</var>: Длительность перекрытия в миллисекундах. Когда звуковые
  последовательности вновь смешиваются в непрерывный поток звука, этот
  параметр определяет, насколько будут перекрываться следующие друг за другом
  последовательности.<br>
  <br>
  Это не слишком критичный параметр. Если вы уменьшаете значение
  <var>Sequence</var> от большей величины, вы можете попробовать меньшие
  значения <var>Overlap</var>.
  </li>
  <li><var>QuickSeek</var>: Процедура time-stretch имеет быстрый режим, который
  существенно увеличивает скорость работы алгоритма, но приводит к ухудшению
  качества звучания.
  </li>
  <li><var>aa</var>: Управляет количеством отводов (tap) противопомехового (Anti-alias)
  фильтра, используемого при изменении скорости следования отсчетов. Устанавливается в 0 
  для запрета фильтра. Значение должно быть кратным 4.
  </li>
</ul>

<p>Следующая таблица подводит итог в подборе параметров
в случае разных приложений:</p>
<table border="1">
  <tbody>
    <tr>
      <td valign="top"><b>Имя параметра</b></td>
      <td valign="top"><b>Значение по
умолчанию</b></td>
      <td valign="top"><b>Влияние максимального
значения...</b></td>
      <td valign="top"><b>Влияние минимального
значения...</b></td>
      <td valign="top"><b>Музыка</b></td>
      <td valign="top"><b>Речь</b></td>
      <td valign="top"><b>Влияние на загрузку процессора</b></td>
    </tr>
    <tr>
      <td valign="top">
      <pre>Sequence</pre>
      </td>
      <td valign="top">Значение по умолчанию относительно
большое, выбрано для замедления темпа музыки</td>
      <td valign="top">Большее значение обычно лучше
для замедления темпа. Увеличение значения притормаживает 
"эхо"-артефакты при замедлении темпа.</td>
      <td valign="top">Меньшие значения должны быть лучше
при увеличении темпа. Уменьшение значения убыстряет 
"эхо"-артефакты при увеличении темпа. </td>
      <td valign="top">Значение по умолчанию обычно подходит</td>
      <td valign="top">Меньшее относительно значения по умолчанию
может быть лучше</td>
      <td valign="top">Увеличение параметра уменьшает
вычислительную сложность</td>
    </tr>
    <tr>
      <td valign="top">
      <pre>SeekWindow</pre>
      </td>
      <td valign="top">Значение по умолчанию относительно
большое, выбрано для замедления темпа музыки</td>
      <td valign="top">С большими значениями лучше находятся
хорошие места перекрытия, но могут вызывать артефакты дрейфа</td>
      <td valign="top">Меньшие значения снижают возможность находить
хорошие места перекрытия, но уменьшают артефакты дрейфа.</td>
      <td valign="top">Значение по умолчанию обычно подходит,
если не беспокоят артефакты дрейфа.</td>
      <td valign="top">Значение по умолчанию обычно подходит</td>
      <td valign="top">Увеличение параметра увеличивает
вычислительную сложность</td>
    </tr>
    <tr>
      <td valign="top">
      <pre>Overlap</pre>
      </td>
      <td valign="top">Значение по умолчанию относительно
большое, выбрано пригодным для вышеприведенных параметров.</td>
      <td valign="top">&nbsp;</td>
      <td valign="top">Если Вы уменьшите "sequence ms", 
то можете попробовать меньшее значение.</td>
      <td valign="top">&nbsp;</td>
      <td valign="top">&nbsp;</td>
      <td valign="top">Увеличение параметра увеличивает
вычислительную сложность</td>
    </tr>
  </tbody>
</table>

<p><b>Примечание:</b></p>
<p>Плагин НЕ является вполне точным в отношении аудио-выборки. При его 
использовании возможны некоторые неточности. Учитывая использование чисел 
с дробной частью (float) возможно проявление ошибок округления, особенно 
на длинных аудио-выборках. В целом, однако, неточность не должна превышать
10-ов миллисекунд на выборках длинной в фильм.</p>
<p>SoundTouch используется в режиме выборок с дробной частью.</p>
<p><b>Примеры:</b></p>
<pre>TimeStretch(pitch = 200) </pre>
<p>Это приведет к повышению тональности звука <var>pitch</var> на одну октаву 
при неизменной длине исходной выборки.</p>
<pre>TimeStretch(pitch = 100.0*pow(2.0, 1.0/12.0)) </pre>
<p>Это приведет к повышению тональности звука  <var>pitch</var> на один полу-тон
при неизменной длине исходной выборки.</p>
<pre>TimeStretch(tempo = (100.0*25.0*1001.0)/24000.0)</pre>
<p>Это приведет к  изменению темпа <var>tempo</var> воспроизведения звука для 
преобразования из кинофильма в PAL без изменения тональности.</p>
<p><b>Благодарности:</b></p>
<p>Эта функция использует:</p>
<p>SoundTouch library Copyright (c) Olli Parviainen 2002-2006</p>
<p><a href="http://www.iki.fi/oparviai/soundtouch">http://www.iki.fi/oparviai/soundtouch</a><br>
<a href="http://www.surina.net/soundtouch">http://www.surina.net/soundtouch</a></p>
<p><b>История изменений:</b></p>
<table border="1">
  <tbody>
    <tr>
      <td>v2.55</td>
      <td>Исходная реализация</td>
    </tr>
    <tr>
      <td>v2.57</td>
      <td>Задокументированы ряд параметров soundtouch</td>
    </tr>
  </tbody>
</table>

<p><kbd>$English Date: 2006/04/08 10:43:32 $<br>
Русский перевод 15.05.2005-12.04.2006 Turyst04 Turyst04@nm.ru</kbd></p>
<form>
  <p><input TYPE="Button" VALUE="Back"
onClick="history.go(-1)"></p>
</form>

</body>
</html>